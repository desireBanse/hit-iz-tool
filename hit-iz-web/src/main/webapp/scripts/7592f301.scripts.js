"use strict";angular.module("commonServices",[]),angular.module("common",["ngResource","my.resource","default","xml","hl7v2-edi","hl7v2","edi","soap"]),angular.module("cf",["common"]),angular.module("doc",["common"]),angular.module("cb",["common"]),angular.module("envelope",["soap"]),angular.module("connectivity",["soap"]),angular.module("isolated",["common"]),angular.module("hit-tool-directives",[]),angular.module("hit-tool-services",["common"]),angular.module("documentation",[]);var app=angular.module("tool",["ngRoute","ui.bootstrap","ngCookies","LocalStorageModule","ngResource","ngSanitize","ngIdle","ngAnimate","ui.bootstrap","angularBootstrapNavTree","QuickList","format","soap","default","hl7v2-edi","xml","hl7v2","edi","soap","envelope","connectivity","cf","cb","isolated","ngTreetable","blueimp.fileupload","hit-tool-directives","hit-tool-services","commonServices","smart-table","doc","hit-vocab-search","hit-profile-viewer","hit-validation-result","hit-report-viewer","hit-testcase-details","hit-testcase-tree","hit-doc","hit-dqa","hit-settings","documentation","hit-manual-report-viewer"]),httpHeaders;app.config(["$routeProvider","$httpProvider","localStorageServiceProvider","KeepaliveProvider","IdleProvider",function(a,b,c,d,e){c.setPrefix("hit-tool").setStorageType("sessionStorage"),a.when("/",{templateUrl:"views/home.html"}).when("/home",{templateUrl:"views/home.html"}).when("/doc",{templateUrl:"views/doc.html"}).when("/setting",{templateUrl:"views/setting.html"}).when("/about",{templateUrl:"views/about.html"}).when("/contact",{templateUrl:"views/contact.html"}).when("/soapEnv",{templateUrl:"views/envelope/envelope.html"}).when("/soapConn",{templateUrl:"views/connectivity/connectivity.html"}).when("/cf",{templateUrl:"views/cf/cf.html"}).when("/cb",{templateUrl:"views/cb/cb.html"}).when("/blank",{templateUrl:"blank.html"}).when("/error",{templateUrl:"error.html"}).when("/transport-settings",{templateUrl:"views/transport-settings.html"}).otherwise({redirectTo:"/"}),b.interceptors.push("ErrorInterceptor"),e.idle(7200),e.timeout(30),d.interval(10),httpHeaders=b.defaults.headers}]),app.factory("ErrorInterceptor",["$q","$rootScope","$location","StorageService","$window",function(a,b){var c=function(a){440===a.status?(a.data="Session timeout",b.openSessionExpiredDlg()):498===a.status?(a.data="Invalid Application State",b.openVersionChangeDlg()):401===a.status&&b.openInvalidReqDlg()};return{responseError:function(b){return c(b),a.reject(b)}}}]),app.run(["Session","$rootScope","$location","$modal","TestingSettings","AppInfo","$q","$sce","$templateCache","$compile","StorageService","$window","$route","$timeout","$http","User","Idle","Transport",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(){b.warning&&(b.warning.close(),b.warning=null),b.timedout&&(b.timedout.close(),b.timedout=null)}b.appInfo={},b.stackPosition=0,b.transportSupported=!1,b.scrollbarWidth=null,b.vcModalInstance=null,b.sessionExpiredModalInstance=null,b.errorModalInstanceInstance=null,a.create().then(function(){p.load().then(function(){r.init()},function(){b.openCriticalErrorDlg("Sorry we could not create a new user for your session. Please refresh the page and try again.")}),f.get().then(function(a){b.appInfo=a,httpHeaders.common.rsbVersion=a.rsbVersion;var c=k.get(k.APP_STATE_TOKEN);null!=c&&c!==a.rsbVersion&&b.openVersionChangeDlg(),k.set(k.APP_STATE_TOKEN,a.rsbVersion)},function(){b.appInfo={},b.openCriticalErrorDlg("Sorry we could not communicate with the server. Please try again")})},function(){b.openCriticalErrorDlg("Sorry we could not start your session. Please refresh the page and try again.")}),b.$watch(function(){return c.path()},function(a){if(b.activePath===a){var c,d=l.history.state;c=!!(d&&d.position<=b.stackPosition),c?b.stackPosition--:b.stackPosition++}else m.current&&(l.history.replaceState({position:b.stackPosition},""),b.stackPosition++)}),b.isActive=function(a){return a===b.activePath},b.setActive=function(a){""===a||"/"===a?c.path("/home"):b.activePath=a},b.isSubActive=function(a){return a===b.subActivePath},b.setSubActive=function(a){b.subActivePath=a,k.set(k.ACTIVE_SUB_TAB_KEY,a)},b.showError=function(a){var c=d.open({templateUrl:"ErrorDlgDetails.html",controller:"ErrorDetailsCtrl",resolve:{error:function(){return a}}});c.result.then(function(a){b.error=a},function(){})},b.cutString=function(a){return a.length>20&&(a=a.substring(0,20)+"..."),a},b.toHTML=function(a){return h.trustAsHtml(a)},b.selectTestingType=function(a){b.tabs[0]=!1,b.tabs[1]=!1,b.tabs[2]=!1,b.tabs[3]=!1,b.tabs[4]=!1,b.tabs[5]=!1,b.activeTab=a,b.tabs[b.activeTab]=!0,e.setActiveTab(b.activeTab)},b.downloadArtifact=function(a){var b=document.createElement("form");b.action="api/artifact/download",b.method="POST",b.target="_target";var c=document.createElement("input");c.name="path",c.value=a,b.appendChild(c),b.style.display="none",document.body.appendChild(b),b.submit()},b.tabs=new Array,b.compile=function(a){return j(a)},b.$on("$locationChangeSuccess",function(){b.setActive(c.path())}),b.getScrollbarWidth=function(){if(null==b.scrollbarWidth){var a=document.createElement("div");a.style.visibility="hidden",a.style.width="100px",a.style.msOverflowStyle="scrollbar",document.body.appendChild(a);var c=a.offsetWidth;a.style.overflow="scroll";var d=document.createElement("div");d.style.width="100%",a.appendChild(d);var e=d.offsetWidth;a.parentNode.removeChild(a),b.scrollbarWidth=c-e}return b.scrollbarWidth},b.openValidationResultInfo=function(){d.open({templateUrl:"ValidationResultInfoCtrl.html",windowClass:"profile-modal",controller:"ValidationResultInfoCtrl"})},b.openVersionChangeDlg=function(){k.clearAll(),b.vcModalInstance&&null!==b.vcModalInstance&&b.vcModalInstance.opened||(b.vcModalInstance=d.open({templateUrl:"VersionChanged.html",size:"lg",backdrop:"static",keyboard:"false",controller:"FailureCtrl",resolve:{error:function(){return""}}}),b.vcModalInstance.result.then(function(){b.clearTemplate(),b.reloadPage()},function(){b.clearTemplate(),b.reloadPage()}))},b.openCriticalErrorDlg=function(a){k.clearAll(),b.errorModalInstance&&null!==b.errorModalInstance&&b.errorModalInstance.opened||(b.errorModalInstance=d.open({templateUrl:"CriticalError.html",size:"lg",backdrop:!0,keyboard:"true",controller:"FailureCtrl",resolve:{error:function(){return a}}}),b.errorModalInstance.result.then(function(){b.clearTemplate(),b.reloadPage()},function(){b.clearTemplate(),b.reloadPage()}))},b.openSessionExpiredDlg=function(){k.clearAll(),b.sessionExpiredModalInstance&&null!==b.sessionExpiredModalInstance&&b.sessionExpiredModalInstance.opened||(b.sessionExpiredModalInstance=d.open({templateUrl:"timedout-dialog.html",size:"lg",backdrop:!0,keyboard:"true",controller:"FailureCtrl",resolve:{error:function(){return""}}}),b.sessionExpiredModalInstance.result.then(function(){b.clearTemplate(),b.reloadPage()},function(){b.clearTemplate(),b.reloadPage()}))},b.clearTemplate=function(){i.removeAll()},b.openErrorDlg=function(){c.path("/error")},b.pettyPrintType=function(a){return"TestStep"===a?"Test Step":"TestCase"===a?"Test Case":a},b.reloadPage=function(){l.location.reload()},b.openInvalidReqDlg=function(){b.errorModalInstance&&null!==b.errorModalInstance&&b.errorModalInstance.opened||(b.errorModalInstance=d.open({templateUrl:"InvalidReqCtrl.html",size:"lg",backdrop:!0,keyboard:"false",controller:"FailureCtrl",resolve:{error:function(){return""}}}),b.errorModalInstance.result.then(function(){b.reloadPage()},function(){b.reloadPage()}))},b.openNotFoundDlg=function(){b.errorModalInstance&&null!==b.errorModalInstance&&b.errorModalInstance.opened||(b.errorModalInstance=d.open({templateUrl:"NotFoundCtrl.html",size:"lg",backdrop:!0,keyboard:"false",controller:"FailureCtrl",resolve:{error:function(){return""}}}),b.errorModalInstance.result.then(function(){b.reloadPage()},function(){b.reloadPage()}))},b.nav=function(a){c.path(a)},b.showSettings=function(){d.open({templateUrl:"SettingsCtrl.html",size:"lg",keyboard:"false",controller:"SettingsCtrl"})},b.started=!1,q.watch(),b.$on("IdleStart",function(){s(),b.warning=d.open({templateUrl:"warning-dialog.html",windowClass:"modal-danger"})}),b.$on("IdleEnd",function(){s()}),b.$on("IdleTimeout",function(){s(),k.clearAll(),a.delete().then(function(){b.timedout=d.open({templateUrl:"timedout-dialog.html",windowClass:"modal-danger",backdrop:!0,keyboard:"false",controller:"FailureCtrl",resolve:{error:function(){return""}}}),b.timedout.result.then(function(){b.clearTemplate(),b.reloadPage()},function(){b.clearTemplate(),b.reloadPage()})})}),b.start=function(){s(),q.watch(),b.started=!0},b.stop=function(){s(),q.unwatch(),b.started=!1}}]),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition","$q",function(){}]).directive("carousel",[function(){return{}}]),angular.module("hit-tool-services").factory("TabSettings",["$rootScope",function(){return{"new":function(a){return{key:a,activeTab:0,getActiveTab:function(){return this.activeTab},setActiveTab:function(a){this.activeTab=a,this.save()},save:function(){sessionStorage.setItem(this.key,this.activeTab)},restore:function(){this.activeTab=null!=sessionStorage.getItem(this.key)&&""!=sessionStorage.getItem(this.key)?parseInt(sessionStorage.getItem(this.key)):0}}}}}]),app.controller("ErrorDetailsCtrl",["$scope","$modalInstance","error",function(a,b,c){a.error=c,a.ok=function(){b.close(a.error)},a.cancel=function(){b.dismiss("cancel")},a.refresh=function(){b.close($window.location.reload())}}]),app.directive("stRatio",function(){return{link:function(a,b,c){var d=+c.stRatio;b.css("width",d+"%")}}}),angular.module("commonServices").factory("Clock",["$interval",function(a){var b=function(a){this.value=void 0,this.intervl=a};return b.prototype.start=function(b){angular.isDefined(this.value)&&this.stop(),this.value=a(b,this.intervl)},b.prototype.stop=function(){angular.isDefined(this.value)&&(a.cancel(this.value),this.value=void 0)},b}]),app.controller("TableFoundCtrl",["$scope","$modalInstance","table",function(a,b,c){a.table=c,a.tmpTableElements=[].concat(null!=c?c.valueSetElements:[]),a.cancel=function(){b.dismiss("cancel")}}]),app.controller("ValidationResultInfoCtrl",["$scope","$modalInstance",function(a,b){a.close=function(){b.dismiss("cancel")}}]),app.filter("capitalize",function(){return function(a){return a?a.charAt(0).toUpperCase()+a.substr(1).toLowerCase():""}}),app.directive("stRatio",function(){return{link:function(a,b,c){var d=+c.stRatio;b.css("width",d+"%")}}}),app.controller("ErrorCtrl",["$scope","$modalInstance","StorageService","$window",function(a,b,c,d){a.refresh=function(){b.close(d.location.reload())}}]),app.controller("FailureCtrl",["$scope","$modalInstance","StorageService","$window","error",function(a,b,c,d,e){a.error=e,a.close=function(){b.close()}}]),angular.module("my.resource",["ngResource"]).factory("Resource",["$resource",function(a){return function(b,c,d){var e={update:{method:"put",isArray:!1},create:{method:"post"}};d=angular.extend(e,d);var f=a(b,c,d);return f.prototype.$save=function(a,b){return this.id?this.$update(a,b):this.$create(a,b)},f}}]),angular.module("hit-tool-services").factory("TestingSettings",["$rootScope",function(){var a={activeTab:0,getActiveTab:function(){return a.activeTab},setActiveTab:function(b){a.activeTab=b,a.save()},save:function(){sessionStorage.TestingActiveTab=a.activeTab},restore:function(){a.activeTab=null!=sessionStorage.TestingActiveTab&&""!=sessionStorage.TestingActiveTab?parseInt(sessionStorage.TestingActiveTab):0}};return a}]),angular.module("envelope").factory("Envelope",["SOAPEditor","SOAPCursor","ValidationResult","IZReportClass","Message","ValidationSettings",function(a,b,c,d,e,f){var g={testCase:null,selectedTestCase:null,editor:new a,cursor:new b,validationResult:new c,message:new e,report:new d,validationSettings:new f,getContent:function(){return g.message.content}};return g}]),angular.module("envelope").factory("EnvelopeTestCaseListLoader",["$q","$http",function(a,b){return function(){var c=a.defer();return b.get("api/envelope/testcases/",{timeout:6e4}).then(function(a){c.resolve(angular.fromJson(a.data))},function(a){c.reject(a.data)}),c.promise}}]),angular.module("envelope").factory("EnvelopeValidator",["$http","$q","SOAPEditorUtils",function(a,b,c){var d=function(){};return d.prototype.validate=function(d,e){var f=b.defer();if(c.isXML(d)){var g=angular.fromJson({content:d});a.post("api/envelope/testcases/"+e+"/validate",g,{timeout:6e4}).then(function(a){f.resolve(angular.fromJson(a.data))},function(a){f.reject(a.data)})}else f.reject("Message provided is not an xml message");return f.promise},d}]),angular.module("cf").factory("CF",["$rootScope","$http","$q","Er7Message","Tree",function(a,b,c,d,e){var f={editor:null,cursor:null,tree:new e,testCase:null,selectedTestCase:null,message:new d,searchTableId:0};return f}]),angular.module("cf").factory("CFTestCaseListLoader",["$q","$http","StorageService","$timeout",function(a,b){return function(){var c=a.defer();return b.get("api/cf/testcases",{timeout:18e4}).then(function(a){c.resolve(angular.fromJson(a.data))},function(a){c.reject(a.data)}),c.promise}}]),angular.module("cb").factory("CB",["Message","ValidationSettings","Tree","StorageService","Transport","Logger","User",function(a,b,c,d,e,f){var g={testCase:null,selectedTestCase:null,editor:null,tree:new c,cursor:null,message:new a,logger:new f,validationSettings:new b,setContent:function(a){g.message.content=a,g.editor.instance.doc.setValue(a),g.message.notifyChange()},getContent:function(){return g.message.content}};return g}]),angular.module("cb").factory("CBTestCaseListLoader",["$q","$http",function(a,b){return function(){var c=a.defer();return b.get("api/cb/testcases",{timeout:18e4}).then(function(a){c.resolve(angular.fromJson(a.data))},function(a){c.reject(a.data)}),c.promise}}]),angular.module("connectivity").factory("Connectivity",["$rootScope","$http","$q","ConnectivityPart","Logger","Endpoint","SOAPConnectivityTransport","StorageService",function(a,b,c,d,e){var f={testCase:null,selectedTestCase:null,logger:new e,request:new d,response:new d};return f}]),angular.module("connectivity").factory("ConnectivityTestCaseListLoader",["$q","$http",function(a,b){return function(){var c=a.defer();return b.get("api/connectivity/testcases").then(function(a){c.resolve(angular.fromJson(a.data))},function(){c.reject("Sorry, failed to fetch the test cases. Please refresh your page.")}),c.promise}}]),angular.module("connectivity").factory("ConnectivityValidator",["$q","$http","SOAPEditorUtils",function(a,b,c){var d=function(){};return d.prototype.validate=function(d,e,f,g){var h=a.defer();if(c.isXML(d)){var i=angular.fromJson({content:d,testCaseId:e,type:f,requestMessage:g});b.post("api/connectivity/validate",i,{timeout:6e4}).then(function(a){h.resolve(angular.fromJson(a.data))},function(a){h.reject(a.data)})}else h.reject("Message provided is not an xml message");return h.promise},d}]),angular.module("connectivity").factory("ConnectivityPart",["$rootScope","$http","$q","SOAPEditor","SOAPCursor","ValidationResult","IZReportClass","Message","ValidationSettings",function(a,b,c,d,e,f,g,h,i){var j=function(){this.editor=new d,this.cursor=new e,this.validationResult=new f,this.message=new h,this.report=new g,this.validationSettings=new i};return j.prototype.setContent=function(a){this.editor.instance.doc.setValue(a)},j.prototype.formatContent=function(){this.editor.format()},j.prototype.getContent=function(){return this.message.content},j}]),angular.module("commonServices").factory("SOAPConnectivityTransport",["$q","$http","Transport","User","StorageService",function(a,b,c,d){var e=function(){this.domain="iz",this.protocol="soap"},e={running:!1,configs:c.configs,transactions:c.transactions,logs:c.logs,disabled:!1,domain:"iz",protocol:"soap",send:function(f){var g=a.defer(),h=this;return h.transactions={},c.deleteTransaction(f).then(function(){var a=angular.fromJson({testStepId:f,userId:d.info.id,config:c.configs[e.domain][e.protocol].data.taInitiator});b.post("api/connectivity/send",a,{timeout:6e4}).then(function(a){h.transactions[f]=null!=a.data&&""!=a.data?angular.fromJson(a.data):null,g.resolve(h.transactions[f])},function(){h.transactions[f]=null,g.reject(h.transactions[f])})}),g.promise},searchTransaction:function(a,b,d){return c.searchTransaction(a,b,d,e.domain,e.protocol)},stopListener:function(a){return c.stopListener(a,e.domain,e.protocol)},startListener:function(a,b){return c.startListener(a,b,e.domain,e.protocol)}};return e}]),angular.module("commonServices").factory("StorageService",["$rootScope","localStorageService",function(a,b){var c={CF_EDITOR_CONTENT_KEY:"CF_EDITOR_CONTENT",CF_LOADED_TESTCASE_ID_KEY:"CF_LOADED_TESTCASE_ID",CF_LOADED_TESTCASE_TYPE_KEY:"CF_LOADED_TESTCASE_TYPE",CB_EDITOR_CONTENT_KEY:"CB_EDITOR_CONTENT",CB_SELECTED_TESTCASE_ID_KEY:"CB_SELECTED_TESTCASE_ID",CB_SELECTED_TESTCASE_TYPE_KEY:"CB_SELECTED_TESTCASE_TYPE",CB_LOADED_TESTCASE_ID_KEY:"CB_LOADED_TESTCASE_ID",CB_LOADED_TESTCASE_TYPE_KEY:"CB_LOADED_TESTCASE_TYPE",CB_LOADED_TESTSTEP_TYPE_KEY:"CB_LOADED_TESTSTEP_TYPE_KEY",CB_LOADED_TESTSTEP_ID_KEY:"CB_LOADED_TESTSTEP_ID",ISOLATED_EDITOR_CONTENT_KEY:"ISOLATED_EDITOR_CONTENT",ISOLATED_SELECTED_TESTCASE_ID_KEY:"ISOLATED_SELECTED_TESTCASE_ID",ISOLATED_LOADED_TESTCASE_ID_KEY:"ISOLATED_LOADED_TESTCASE_ID",ISOLATED_LOADED_TESTSTEP_ID_KEY:"ISOLATED_LOADED_TESTSTEP_ID",ISOLATED_LOADED_TESTSTEP_TYPE_KEY:"ISOLATED_LOADED_TESTSTEP_TYPE",ISOLATED_SELECTED_TESTCASE_TYPE_KEY:"ISOLATED_SELECTED_TESTCASE_TYPE",ISOLATED_LOADED_TESTCASE_TYPE_KEY:"ISOLATED_LOADED_TESTCASE_TYPE",SOAP_ENV_EDITOR_CONTENT_KEY:"SOAP_ENV_EDITOR_CONTENT",SOAP_ENV_SELECTED_TESTCASE_ID_KEY:"SOAP_ENV_SELECTED_TESTCASE_ID",SOAP_ENV_SELECTED_TESTCASE_TYPE_KEY:"SOAP_ENV_SELECTED_TESTCASE_TYPE",SOAP_ENV_LOADED_TESTCASE_ID_KEY:"SOAP_ENV_LOADED_TESTCASE_ID",SOAP_ENV_LOADED_TESTCASE_TYPE_KEY:"SOAP_ENV_LOADED_TESTCASE_TYPE",SOAP_CONN_REQ_EDITOR_CONTENT_KEY:"SOAP_CONN_REQ_EDITOR_CONTENT",SOAP_CONN_RESP_EDITOR_CONTENT_KEY:"SOAP_CONN_RESP_EDITOR_CONTENT",SOAP_CONN_SELECTED_TESTCASE_ID_KEY:"SOAP_CONN_SELECTED_TESTCASE_ID",SOAP_CONN_SELECTED_TESTCASE_TYPE_KEY:"SOAP_CONN_SELECTED_TESTCASE_TYPE",SOAP_CONN_LOADED_TESTCASE_ID_KEY:"SOAP_CONN_LOADED_TESTCASE_ID",SOAP_CONN_LOADED_TESTCASE_TYPE_KEY:"SOAP_CONN_LOADED_TESTCASE_TYPE",ACTIVE_SUB_TAB_KEY:"ACTIVE_SUB_TAB",DQA_OPTIONS_KEY:"DQA_OPTIONS_KEY",SETTINGS_KEY:"SETTINGS_KEY",USER_KEY:"USER_KEY",USER_CONFIG_KEY:"USER_CONFIG_KEY",TRANSPORT_CONFIG_KEY:"TRANSPORT_CONFIG_KEY",APP_STATE_TOKEN:"APP_STATE_TOKEN",TRANSPORT_DISABLED:"TRANSPORT_DISABLED",remove:function(a){return b.remove(a)},removeList:function(a,c,d){return b.remove(a,c,d)},clearAll:function(){return b.clearAll()},set:function(a,c){return b.set(a,c)},get:function(a){return b.get(a)},getTransportConfig:function(a,c){return b.get(a+"-"+c+"-transport-configs")},setTransportConfig:function(a,c,d){return b.set(a+"-"+c+"-transport-configs",d)}};return c}]),angular.module("commonServices").factory("Er7Message",["$http","$q","Message",function(a,b,c){var d=function(){c.apply(this,arguments)};return d.prototype=Object.create(c.prototype),d.prototype.constructor=d,d}]),angular.module("format").factory("IZReportClass",["$http","$q",function(a,b){var c=function(){this.html=null};return c.prototype.generate=function(c){var d=b.defer(),e=this;return a({url:"api/iz/report/generate",data:$.param({content:c}),headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},method:"POST",timeout:6e4}).success(function(a){var b=angular.fromJson(a);e.html=b.htmlReport,d.resolve(e.html)}).error(function(a){e.html=null,d.reject(a)}),d.promise},c.prototype.download=function(a,b,c){var d=document.createElement("form");d.action="api/iz/report/download",d.method="POST",d.target="_target";var e=document.createElement("textarea");e.name="content",e.value=c,d.appendChild(e),e=document.createElement("input"),e.name="format",e.value=a,d.appendChild(e),e=document.createElement("input"),e.name="title",e.value=b,d.appendChild(e),d.style.display="none",document.body.appendChild(d),d.submit()},c}]),angular.module("tool").controller("MainCtrl",["$scope","$rootScope",function(){}]),angular.module("tool").controller("TestingCtrl",["$scope","$q","$rootScope","TestingSettings",function(a,b,c,d){a.loading=!1,a.init=function(){d.restore(),c.selectTestingType(d.getActiveTab())}}]),angular.module("tool").controller("ValidationResultDetailsCtrl",["$scope","$modalInstance","selectedElement",function(a,b,c){a.selectedElement=c,a.ok=function(){b.close(a.selectedElement)},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("cf").controller("CFTestingCtrl",["$scope","$http","CF","$window","$modal","$filter","$rootScope","CFTestCaseListLoader","$timeout","StorageService","TestCaseService","TestStepService",function(a,b,c,d,e,f,g,h,i,j,k,l){a.cf=c,a.loading=!1,a.loadingTC=!1,a.error=null,a.testCases=[],a.testCase=null,a.tree={},a.tabs=new Array,a.error=null,a.collapsed=!1;var m=new k;a.setActiveTab=function(b){a.tabs[0]=!1,a.tabs[1]=!1,a.tabs[2]=!1,a.tabs[3]=!1,a.activeTab=b,a.tabs[a.activeTab]=!0},a.getTestCaseDisplayName=function(a){return a.parentName+" - "+a.label},a.selectTestCase=function(b){a.loadingTC=!0,i(function(){var d=j.get(j.CF_LOADED_TESTCASE_ID_KEY);if(null!=d&&l.clearRecords(d),b.testContext&&null!=b.testContext){c.testCase=b,a.testCase=c.testCase;var e=j.get(j.CF_LOADED_TESTCASE_ID_KEY);e!=b.id&&(j.set(j.CF_LOADED_TESTCASE_ID_KEY,b.id),j.remove(j.CF_EDITOR_CONTENT_KEY)),a.$broadcast("cf:testCaseLoaded",a.testCase),a.$broadcast("cf:profileLoaded",a.testCase.testContext.profile),a.$broadcast("cf:valueSetLibraryLoaded",a.testCase.testContext.vocabularyLibrary)}a.loadingTC=!1})},a.refreshTree=function(){i(function(){if(null!=a.testCases)if("function"==typeof a.tree.build_all){a.tree.build_all(a.testCases);var b=null,c=j.get(j.CF_LOADED_TESTCASE_ID_KEY);if(null!=c)for(var d=0;d<a.testCases.length;d++){var e=m.findOneById(c,a.testCases[d]);if(null!=e){b=e;break}}null==b&&null!=a.testCases&&a.testCases.length>=0&&(b=a.testCases[0]),null!=b&&a.selectNode(b.id,b.type),a.expandAll(),a.error=null}else a.error="Ooops, Something went wrong. Please refresh your page again.";a.loading=!1},1e3)},a.initTesting=function(){j.remove(j.ACTIVE_SUB_TAB_KEY),a.error=null,a.testCases=[],a.loading=!0;var b=new h;b.then(function(b){angular.forEach(b,function(a){m.buildCFTestCases(a)}),a.testCases=f("orderBy")(b,"position"),a.refreshTree()},function(){a.error="Sorry, Cannot load the profiles. Try again",a.loading=!1}),a.$on("$destroy",function(){var a=j.get(j.CF_LOADED_TESTCASE_ID_KEY);null!=a&&l.clearRecords(a)})},a.selectNode=function(b,c){i(function(){m.selectNodeByIdAndType(a.tree,b,c)},0)},a.openProfileInfo=function(){e.open({templateUrl:"CFProfileInfoCtrl.html",windowClass:"profile-modal",controller:"CFProfileInfoCtrl"})},a.isSelectable=function(a){return a.testContext&&null!=a.testContext},a.expandAll=function(){null!=a.tree&&a.tree.expand_all()},a.collapseAll=function(){null!=a.tree&&a.tree.collapse_all()}}]),angular.module("cf").controller("CFProfileInfoCtrl",["$scope","$modalInstance",function(a,b){a.close=function(){b.dismiss("cancel")}}]),angular.module("cf").controller("CFValidatorCtrl",["$scope","$http","CF","$window","$timeout","$modal","NewValidationResult","$rootScope","ServiceDelegator","StorageService","TestStepService",function(a,b,c,d,e,f,g,h,i,j,k){a.cf=c,a.testCase=c.testCase,a.message=c.message,a.selectedMessage={},a.loading=!0,a.error=null,a.vError=null,a.vLoading=!0,a.mError=null,a.mLoading=!0,a.delimeters=[],a.counter=0,a.type="cf",a.loadRate=4e3,a.tokenPromise=null,a.editorInit=!1,a.nodelay=!1,a.resized=!1,a.selectedItem=null,a.activeTab=0,a.tError=null,a.tLoading=!1,a.dqaCodes=null!=j.get(j.DQA_OPTIONS_KEY)?angular.fromJson(j.get(j.DQA_OPTIONS_KEY)):[],a.showDQAOptions=function(){var b=f.open({templateUrl:"DQAConfig.html",controller:"DQAConfigCtrl",windowClass:"dq-modal",animation:!0,keyboard:!1,backdrop:!1});b.result.then(function(b){a.dqaCodes=b},function(){})},a.hasContent=function(){return""!=a.cf.message.content&&null!=a.cf.message.content},a.refreshEditor=function(){e(function(){a.editor&&a.editor.refresh()},1e3)},a.options={paramName:"file",formAcceptCharset:"utf-8",autoUpload:!0,type:"POST"},a.$on("fileuploadadd",function(b,c){(c.autoUpload||c.autoUpload!==!1&&$(this).fileupload("option","autoUpload"))&&c.process().done(function(){var b=c.files[0].name;c.url="api/message/upload";c.submit().success(function(c){a.nodelay=!0;var d=angular.fromJson(c);a.cf.message.name=b,a.cf.editor.instance.doc.setValue(d.content),a.mError=null,a.execute()}).error(function(c,d,e){a.cf.message.name=b,a.mError="Sorry, Cannot upload file: "+b+", Error: "+e}).complete(function(){})})}),a.loadMessage=function(){a.cf.testCase.testContext.message&&null!=a.cf.testCase.testContext.message&&(a.nodelay=!0,a.selectedMessage=a.cf.testCase.testContext.message,null!=a.selectedMessage&&null!=a.selectedMessage.content?a.editor.doc.setValue(a.selectedMessage.content):(a.editor.doc.setValue(""),a.cf.message.id=null,a.cf.message.name=""),a.execute())},a.setLoadRate=function(b){a.loadRate=b},a.initCodemirror=function(){a.editor=CodeMirror.fromTextArea(document.getElementById("cfTextArea"),{lineNumbers:!0,fixedGutter:!0,theme:"elegant",readOnly:!1,showCursorWhenSelecting:!0,gutters:["CodeMirror-linenumbers","cm-edi-segment-name"]}),a.editor.setSize("100%",345),a.editor.on("keyup",function(){e(function(){var b=a.editor.doc.getValue();a.error=null,a.tokenPromise&&(e.cancel(a.tokenPromise),a.tokenPromise=void 0),c.message.name=null,""!==b.trim()?a.tokenPromise=e(function(){a.execute()},a.loadRate):a.execute()})}),a.editor.on("dblclick",function(){e(function(){var b=i.getCursorService(a.testCase.testContext.format).getCoordinate(a.editor,a.cf.tree);b.lineNumber=b.line,b.startIndex=b.startIndex+1,b.endIndex=b.endIndex+1,a.cf.cursor.init(b,!0),i.getTreeService(a.testCase.testContext.format).selectNodeByIndex(a.cf.tree.root,c.cursor,c.message.content)})})},a.validateMessage=function(){try{if(a.vLoading=!0,a.vError=null,null!=a.cf.testCase&&""!==a.cf.message.content){var b=a.cf.testCase.testContext.id,c=a.cf.message.content,d=(a.cf.testCase.label,i.getMessageValidator(a.testCase.testContext.format).validate(b,c,null,"Free",a.cf.testCase.testContext.dqa===!0?a.dqaCodes:[],"1223"));d.then(function(b){a.vLoading=!1,a.loadValidationResult(b)},function(b){a.vLoading=!1,a.vError=b,a.loadValidationResult(null)})}else a.loadValidationResult(null),a.vLoading=!1,a.vError=null}catch(e){a.vLoading=!1,a.vError=e,a.loadValidationResult(null)}},a.loadValidationResult=function(b){e(function(){a.$broadcast("cf:validationResultLoaded",b,a.cf.testCase.id)})},a.select=function(b){if(void 0!=b&&null!=b.path&&-1!=b.line){var c=i.getTreeService(a.testCase.testContext.format).selectNodeByPath(a.cf.tree.root,b.line,b.path),d=null!=c?c.data:null;a.cf.cursor.init(null!=d?d.lineNumber:b.line,null!=d?d.startIndex-1:b.column-1,null!=d?d.endIndex-1:b.column-1,null!=d?d.startIndex-1:b.column-1,!1),i.getEditorService(a.testCase.testContext.format).select(a.editor,a.cf.cursor)}},a.clearMessage=function(){a.nodelay=!0,a.mError=null,a.editor&&(a.editor.doc.setValue(""),a.execute())},a.saveMessage=function(){a.cf.message.download()},a.parseMessage=function(){try{if(null!=a.cf.testCase&&null!=a.cf.testCase.testContext&&""!=a.cf.message.content){a.tLoading=!0;var b=i.getMessageParser(a.testCase.testContext.format).parse(a.cf.testCase.testContext.id,a.cf.message.content);b.then(function(b){a.tLoading=!1,a.cf.tree.root.build_all(b.elements),i.updateEditorMode(a.editor,b.delimeters,a.cf.testCase.testContext.format),i.getEditorService(a.testCase.testContext.format).setEditor(a.editor),i.getTreeService(a.testCase.testContext.format).setEditor(a.editor)},function(b){a.tLoading=!1,a.tError=b})}else"function"==typeof a.cf.tree.root.build_all&&a.cf.tree.root.build_all([]),a.tError=null,a.tLoading=!1}catch(c){a.tLoading=!1,a.tError=c}},a.onNodeSelect=function(b){i.getTreeService(a.testCase.testContext.format).getEndIndex(b,a.cf.message.content),a.cf.cursor.init(b.data,!1),i.getEditorService(a.testCase.testContext.format).select(a.editor,a.cf.cursor)},a.execute=function(){null!=a.cf.testCase&&(a.tokenPromise&&(e.cancel(a.tokenPromise),a.tokenPromise=void 0),a.error=null,a.tError=null,a.mError=null,a.vError=null,a.cf.message.content=a.editor.doc.getValue(),j.set(j.CF_EDITOR_CONTENT_KEY,a.cf.message.content),a.validateMessage(),a.parseMessage(),a.refreshEditor())},a.removeDuplicates=function(){a.vLoading=!0,a.$broadcast("cf:removeDuplicates")},a.initValidation=function(){a.vLoading=!1,a.tLoading=!1,a.mLoading=!1,a.error=null,a.tError=null,a.mError=null,a.vError=null,a.initCodemirror(),a.refreshEditor(),a.$on("cf:testCaseLoaded",function(b,c){if(a.testCase=c,null!=a.testCase){var d=null==j.get(j.CF_EDITOR_CONTENT_KEY)?"":j.get(j.CF_EDITOR_CONTENT_KEY);a.nodelay=!0,a.mError=null,a.cf.editor=i.getEditor(a.testCase.testContext.format),a.cf.editor.instance=a.editor,a.cf.cursor=i.getCursor(a.testCase.testContext.format),k.clearRecords(a.testCase.id),a.editor&&(a.editor.doc.setValue(d),a.execute())}}),h.$on("cf:duplicatesRemoved",function(){a.vLoading=!1})},a.expandAll=function(){null!=a.cf.tree.root&&a.cf.tree.root.expand_all()},a.collapseAll=function(){null!=a.cf.tree.root&&a.cf.tree.root.collapse_all()}}]),angular.module("cf").controller("CFReportCtrl",["$scope","$sce","$http","CF",function(a,b,c,d){a.cf=d}]),angular.module("cf").controller("CFVocabularyCtrl",["$scope","CF",function(a,b){a.cf=b}]),angular.module("cf").controller("CFProfileViewerCtrl",["$scope","CF","$rootScope",function(a,b){a.cf=b}]),angular.module("cb").controller("CBTestingCtrl",["$scope","$window","$rootScope","CB","StorageService","$timeout","TestCaseService","TestStepService",function(a,b,c,d,e,f,g,h){a.testCase=null,a.initTesting=function(){var b=e.get(e.ACTIVE_SUB_TAB_KEY);(null==b||"/cb_execution"!=b)&&(b="/cb_testcase"),c.setSubActive(b),a.$on("cb:testCaseLoaded",function(b,c){a.testCase=c}),a.$on("$destroy",function(){var a=e.get(e.CB_LOADED_TESTCASE_ID_KEY);null!=a&&g.clearRecords(a),a=e.get(e.CB_LOADED_TESTSTEP_ID_KEY),null!=a&&h.clearRecords(a)})},a.setSubActive=function(b){c.setSubActive(b),"/cb_execution"===b&&a.$broadcast("cb:refreshEditor")}}]),angular.module("cb").controller("CBExecutionCtrl",["$scope","$window","$rootScope","CB","$modal","TestExecutionClock","Endpoint","TestExecutionService","$timeout","StorageService","User","ReportService","SOAPEscaper","TestCaseDetailsService","$compile","Transport",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){a.targ="cb-executed-test-step",a.loading=!1,a.error=null,a.tabs=new Array,a.testCase=null,a.testStep=null,a.logger=d.logger,a.connecting=!1,a.transport=p,a.endpoint=null,a.hidePwd=!0,a.sent=null,a.received=null,a.configCollapsed=!0,a.counterMax=30,a.counter=0,a.listenerReady=!1,a.testStepListCollapsed=!1,a.warning=null,a.sutInititiatorForm="",a.taInititiatorForm="",a.user=k,a.domain=null,a.protocol=null,a.exampleMessageEditor=null,a.initExecution=function(){a.$on("cb:testCaseLoaded",function(b,c,d){a.executeTestCase(c,d)})};var q=["Incorrect message Received. Please check the log for more details","No Outbound message found","Invalid message Received. Please see console for more details.","Invalid message Sent. Please see console for more details."],r=function(a){var b=new X2JS,c=b.xml_str2json(a),d=m.decodeXml(c.Envelope.Body.submitSingleMessage.hl7Message.toString());return d},s=function(a){var b=new X2JS,c=b.xml_str2json(a),d=m.decodeXml(c.Envelope.Body.submitSingleMessageResponse.return.toString());return d};a.setTestStepExecutionTab=function(b){a.tabs[0]=!1,a.tabs[1]=!1,a.tabs[2]=!1,a.tabs[3]=!1,a.tabs[4]=!1,a.tabs[5]=!1,a.tabs[6]=!1,a.tabs[7]=!1,a.tabs[8]=!1,a.tabs[9]=!1,a.activeTab=b,a.tabs[a.activeTab]=!0,5===a.activeTab?a.buildExampleMessageEditor():6===a.activeTab?a.loadArtifactHtml("jurorDocument"):7===a.activeTab?a.loadArtifactHtml("messageContent"):8===a.activeTab?a.loadArtifactHtml("testDataSpecification"):9===a.activeTab&&a.loadArtifactHtml("testStory")
},a.getTestType=function(){return d.testCase.type},a.disabled=function(){return null==d.testCase||null===d.testCase.id},a.getTestType=function(){return null!=a.testCase?a.testCase.type:""},a.loadTestStepDetails=function(b){var c=a.targ+"-testStory",d=a.targ+"-jurorDocument",e=a.targ+"-messageContent",f=a.targ+"-testDataSpecification";n.removeHtml(f),n.removeHtml(e),n.removeHtml(d),n.removeHtml(c),a.$broadcast(c,b.testStory,b.name+"-TestStory"),a.$broadcast(d,b.jurorDocument,b.name+"-JurorDocument"),a.$broadcast(e,b.messageContent,b.name+"-MessageContent"),a.$broadcast(f,b.testDataSpecification,b.name+"-TestDataSpecification"),a.isManualStep(b)&&a.setTestStepExecutionTab(10)},a.loadTestStepExecutionPanel=function(b){a.exampleMessageEditor=null,a.detailsError=null,a.setTestStepExecutionTab(0);var c=b.testContext;i(c&&null!=c?function(){a.$broadcast("cb:testStepLoaded",b),a.$broadcast("cb:profileLoaded",c.profile),a.$broadcast("cb:valueSetLibraryLoaded",c.vocabularyLibrary),n.removeHtml(a.targ+"-exampleMessage");var d=c.message&&c.message.content&&null!=c.message.content?c.message.content:null;null!=d&&a.$broadcast(a.targ+"-exampleMessage",d,c.format,b.name)}:function(){a.$broadcast("cb:manualTestStepLoaded",b)});a.targ+"-exampleMessage";n.details("TestStep",b.id).then(function(c){b.testStory=c.testStory,b.jurorDocument=c.jurorDocument,b.testDataSpecification=c.testDataSpecification,b.messageContent=c.messageContent,a.loadTestStepDetails(b),a.detailsError=null},function(){b.testStory=null,b.testPackage=null,b.jurorDocument=null,b.testDataSpecification=null,b.messageContent=null,a.loadTestStepDetails(b),a.detailsError="Sorry, could not load the test step details. Please try again"})},a.buildExampleMessageEditor=function(){var b=a.targ+"-exampleMessage";null!==a.exampleMessageEditor&&a.exampleMessageEditor||i(function(){a.exampleMessageEditor=n.buildExampleMessageEditor(b,a.testStep.testContext.message.content,a.exampleMessageEditor,a.testStep.testContext&&null!=a.testStep.testContext?a.testStep.testContext.format:null)},100),i(function(){$("#"+b)&&$("#"+b).scrollLeft()},1e3)},a.loadArtifactHtml=function(b){if(null!=a.testStep){var c=n.loadArtifactHtml(a.targ+"-"+b,a.testStep[b]);c&&null!=c&&o(c.contents())(a)}},a.resetTestCase=function(){null!=d.editor&&null!=d.editor.instance&&d.editor.instance.setOption("readOnly",!1),j.remove(j.CB_LOADED_TESTSTEP_TYPE_KEY),j.remove(j.CB_LOADED_TESTSTEP_ID_KEY),a.executeTestCase(a.testCase)},a.selectTestStep=function(b){if(d.testStep=b,a.testStep=b,null!=b)if(j.set(j.CB_LOADED_TESTSTEP_TYPE_KEY,a.testStep.type),j.set(j.CB_LOADED_TESTSTEP_ID_KEY,a.testStep.id),a.isManualStep(b))a.loadTestStepExecutionPanel(b);else if(void 0===b.executionMessage&&"TA_INITIATOR"===b.testingType)if(a.transport.disabled||null==a.domain||null==a.protocol)h.setExecutionMessage(b,b.testContext.message.content),a.loadTestStepExecutionPanel(b);else{var c=a.transport.populateMessage(b.id,b.testContext.message.content,a.domain,a.protocol);c.then(function(c){h.setExecutionMessage(b,c.outgoingMessage),a.loadTestStepExecutionPanel(b)},function(){h.setExecutionMessage(b,b.testContext.message.content),a.loadTestStepExecutionPanel(b)})}else a.loadTestStepExecutionPanel(b)},a.clearTestStep=function(){d.testStep=null,a.testStep=null,a.$broadcast("cb:removeTestStep")},a.getExecutionStatus=function(a){return h.getExecutionStatus(a)},a.getValidationStatus=function(a){return h.getValidationStatus(a)},a.getValidationReport=function(a){return h.getValidationReport(a)},a.getManualValidationStatusTitle=function(a){return h.getManualValidationStatusTitle(a)},a.isManualStep=function(a){return null!=a&&("TA_MANUAL"===a.testingType||"SUT_MANUAL"===a.testingType)},a.isSutInitiator=function(a){return"SUT_INITIATOR"==a.testingType},a.isTaInitiator=function(a){return"TA_INITIATOR"==a.testingType},a.isStepCompleted=function(b){return"COMPLETE"==a.getExecutionStatus(b)},a.completeStep=function(a){h.setExecutionStatus(a,"COMPLETE")},a.completeManualStep=function(b){a.completeStep(b)},a.progressStep=function(a){h.setExecutionStatus(a,"IN_PROGRESS")},a.goNext=function(b){a.isLastStep(b)?a.completeTestCase():a.executeTestStep(a.findNextStep(b.position))},a.goBack=function(b){a.isFirstStep(b)||a.executeTestStep(a.findPreviousStep(b.position))},a.executeTestStep=function(b){d.testStep=b,a.warning=null;var c=a.transport.logs[b.id];a.logger.content=c&&null!=c?c:"",null!=b&&a.selectTestStep(b)},a.completeTestCase=function(){a.testCase.executionStatus="COMPLETE",null!=d.editor.instance&&d.editor.instance.setOption("readOnly",!0),a.clearTestStep()},a.isTestCaseCompleted=function(){return a.testCase&&"COMPLETE"===a.testCase.executionStatus},a.isTestStepCompleted=function(b){return null!=b&&"COMPLETE"==a.getExecutionStatus(b)},a.shouldNextStep=function(b){return null!=a.testStep&&a.testStep===b&&!a.isTestCaseCompleted()&&!a.isLastStep(b)&&a.isTestStepCompleted(b)},a.isLastStep=function(b){return null!=b&&null!=a.testCase&&a.testCase.children.length===b.position},a.isFirstStep=function(b){return null!=b&&null!=a.testCase&&1===b.position},a.isTestCaseSuccessful=function(){if(null!=a.testCase)for(var b=0;b<a.testCase.children.length;b++)if(a.getValidationStatus(a.testCase.children[b])>0)return!1;return!0},a.testStepSucceed=function(b){return a.getValidationStatus(b)<=0},a.findNextStep=function(b){for(var c=0;c<a.testCase.children.length;c++)if(a.testCase.children[c].position===b+1)return a.testCase.children[c];return null},a.findPreviousStep=function(b){for(var c=0;c<a.testCase.children.length;c++)if(a.testCase.children[c].position===b-1)return a.testCase.children[c];return null},a.clearExecution=function(){if(null!=d.editor&&null!=d.editor.instance&&d.editor.instance.setOption("readOnly",!1),null!=a.testCase){for(var b=0;b<a.testCase.children.length;b++){var c=a.testCase.children[b];h.deleteExecutionStatus(c),h.deleteValidationReport(c),h.deleteExecutionMessage(c),h.deleteMessageTree(c)}a.testCase.executionStatus&&delete a.testCase.executionStatus}},a.setNextStepMessage=function(b){var c=a.findNextStep(a.testStep.position);null==c||a.isManualStep(c)||(a.completeStep(c),h.setExecutionMessage(c,b))},a.log=function(b){a.logger.log(b)},a.isValidConfig=function(){},a.outboundMessage=function(){return null!=a.testStep?a.testStep.testContext.message.content:null},a.hasUserContent=function(){return d.editor&&null!=d.editor&&null!=d.editor.instance.doc.getValue()&&""!=d.editor.instance.doc.getValue()},a.hasRequestContent=function(){return null!=a.outboundMessage()&&""!=a.outboundMessage()},a.send=function(){a.connecting=!0,a.openConsole(a.testStep),a.logger.clear(),a.progressStep(a.testStep),a.error=null,a.hasUserContent()?(a.received="",a.logger.log("Sending outbound Message. Please wait..."),a.transport.send(a.testStep.id,d.editor.instance.doc.getValue(),a.domain,a.protocol).then(function(b){var c=b.incoming,d=b.outgoing;if(a.logger.log("Outbound Message  -------------------------------------->"),null!=d&&""!=d)if(a.logger.log(d),a.logger.log("Inbound Message  <--------------------------------------"),null!=c&&""!=c)try{a.completeStep(a.testStep);var e=s(c);a.logger.log(c),a.setNextStepMessage(e)}catch(f){a.error=q[0],a.logger.log("An error occured: "+a.error)}else a.logger.log("No Inbound message received");else a.logger.log("No outbound message sent");a.connecting=!1,a.transport.logs[a.testStep.id]=a.logger.content,a.logger.log("Transaction completed")},function(b){a.connecting=!1,a.error=b.data,a.logger.log("Error: "+b.data),a.received="",a.completeStep(a.testStep),a.transport.logs[a.testStep.id]=a.logger.content,a.logger.log("Transaction stopped")})):(a.error="No message to send",a.connecting=!1,a.transport.logs[a.testStep.id]=a.logger.content,a.logger.log("Transaction completed"))},a.viewConsole=function(b){a.consoleDlg&&null!==a.consoleDlg&&a.consoleDlg.opened&&a.consoleDlg.dismiss("cancel"),a.consoleDlg=e.open({templateUrl:"PastTestStepConsole.html",controller:"PastTestStepConsoleCtrl",windowClass:"console-modal",size:"sm",animation:!0,keyboard:!0,backdrop:!0,resolve:{log:function(){return a.transport.logs[b.id]},title:function(){return b.name}}})},a.openConsole=function(b){a.consoleDlg&&null!==a.consoleDlg&&a.consoleDlg.opened&&a.consoleDlg.dismiss("cancel"),a.consoleDlg=e.open({templateUrl:"CurrentTestStepConsole.html",controller:"CurrentTestStepConsoleCtrl",windowClass:"console-modal",size:"sm",animation:!0,keyboard:!0,backdrop:!0,resolve:{logger:function(){return a.logger},title:function(){return b.name}}})},a.stopListener=function(){a.connecting=!1,a.counter=a.counterMax,f.stop(),a.logger.log("Stopping listener. Please wait...."),a.transport.stopListener(a.testStep.id,a.domain,a.protocol).then(function(){a.logger.log("Listener stopped."),a.transport.logs[a.testStep.id]=a.logger.content},function(){})},a.startListener=function(){a.openConsole(a.testStep);var b=a.findNextStep(a.testStep.position);if(null!=b){var c=b.testContext.message.id;a.configCollapsed=!1,a.logger.clear(),a.counter=0,a.connecting=!0,a.error=null,a.warning=null,a.logger.log("Starting listener. Please wait..."),a.transport.startListener(a.testStep.id,c,a.domain,a.protocol).then(function(b){if(b){a.logger.log("Listener started.");var d=function(){++a.counter,a.logger.log("Waiting for Inbound Message....Elapsed time(second):"+a.counter+"s");var b=null;try{b=a.transport.configs[a.domain][a.protocol].data.sutInitiator}catch(d){b=null}a.transport.searchTransaction(a.testStep.id,b,c,a.domain,a.protocol).then(function(b){if(null!=b){var c=b.incoming,d=b.outgoing;if(a.logger.log("Inbound message received <-------------------------------------- "),null!=c&&""!=c)try{var e=r(c);a.log(e),h.setExecutionMessage(a.testStep,e),a.$broadcast("cb:loadEditorContent",e)}catch(f){a.error=q[2],a.logger.log("Incorrect Inbound message type")}else a.logger.log("Incoming message received is empty");if(a.logger.log("Outbound message sent --------------------------------------> "),null!=d&&""!=d)try{var g=s(d);a.log(g),a.setNextStepMessage(g)}catch(f){a.error=q[3],a.logger.log("Incorrect outgoing message type")}else a.logger.log("Outbound message sent is empty");a.stopListener()}else a.counter>=a.counterMax&&(a.warning="We did not receive any incoming message after 30s. <p>Possible cause (1): You are using wrong credentials. Please check the credentials in your outbound message against those created for your system.</p>  <p>Possible cause (2):The endpoint address may be incorrect.   Verify that you are using the correct endpoint address that is displayed by the tool.</p>",a.stopListener())},function(b){a.error=b,a.log("Error: "+b),a.received="",a.sent="",a.stopListener()})};f.start(d)}else a.logger.log("Failed to start listener"),a.logger.log("Transaction stopped"),a.connecting=!1,a.error="Failed to start the listener. Please contact the administrator for any question",f.stop()},function(b){a.connecting=!1,a.counter=a.counterMax,a.error="Failed to start the listener. Error: "+b,a.logger.log(a.error),a.logger.log("Transaction stopped"),f.stop()})}},a.downloadJurorDoc=function(a,b){var c=$("#"+a).html();if(c&&""!=c){var d=document.createElement("form");d.action="api/artifact/generateJurorDoc/pdf",d.method="POST",d.target="_target";var e=document.createElement("textarea");e.name="html",e.value=c,d.appendChild(e);var f=document.createElement("input");f.name="type",f.value="JurorDocument",d.style.display="none",d.appendChild(f);var g=document.createElement("input");g.name="type",g.value=b,d.style.display="none",d.appendChild(g),document.body.appendChild(d),d.submit()}},a.downloadTestArtifact=function(b){if(null!=a.testCase){var c=document.createElement("form");c.action="api/artifact/download",c.method="POST",c.target="_target";var d=document.createElement("input");d.name="path",d.value=b,c.appendChild(d),c.style.display="none",document.body.appendChild(c),c.submit()}},a.executeTestCase=function(b,e){null!=b&&(a.loading=!0,d.testStep=null,a.testStep=null,a.setTestStepExecutionTab(0),e=e&&null!=e?e:"/cb_execution",c.setSubActive(e),"/cb_execution"===e&&a.$broadcast("cb:refreshEditor"),a.logger.clear(),a.error=null,a.warning=null,a.connecting=!1,a.domain=b.domain,a.protocol=b.protocol,d.testCase=b,a.transport.logs={},a.transport.transactions=[],a.testCase=b,f.stop(),a.testCase=b,a.clearExecution(),"TestCase"===b.type?a.executeTestStep(a.testCase.children[0]):"TestStep"===b.type&&a.executeTestStep(b),a.loading=!1)},a.downloadTestCaseReports=function(){null!=a.testCase&&l.downloadTestCaseReports(a.testCase.id)}}]),angular.module("cb").controller("CBTestCaseCtrl",["$scope","$window","$filter","$rootScope","CB","$timeout","CBTestCaseListLoader","$sce","StorageService","TestCaseService","TestStepService",function(a,b,c,d,e,f,g,h,i,j,k){a.selectedTestCase=e.selectedTestCase,a.testCase=e.testCase,a.testCases=[],a.tree={},a.loading=!0,a.loadingTC=!1,a.error=null,a.collapsed=!1;var l=new j;a.initTestCase=function(){a.error=null,a.loading=!0;var b=new g;b.then(function(b){a.error=null,angular.forEach(b,function(a){l.buildTree(a)}),a.testCases=b,a.refreshTree()},function(){a.loading=!1,a.error="Sorry, Cannot load the test cases. Please try again"})},a.refreshTree=function(){f(function(){if(null!=a.testCases)if("function"==typeof a.tree.build_all){a.tree.build_all(a.testCases);var b=null,c=i.get(i.CB_SELECTED_TESTCASE_ID_KEY),d=i.get(i.CB_SELECTED_TESTCASE_TYPE_KEY);if(null!=c&&null!=d){for(var e=0;e<a.testCases.length;e++){var f=l.findOneByIdAndType(c,d,a.testCases[e]);if(null!=f){b=f;break}}null!=b&&a.selectNode(c,d)}if(b=null,c=i.get(i.CB_LOADED_TESTCASE_ID_KEY),d=i.get(i.CB_LOADED_TESTCASE_TYPE_KEY),null!=c&&null!=d){for(var e=0;e<a.testCases.length;e++){var f=l.findOneByIdAndType(c,d,a.testCases[e]);if(null!=f){b=f;break}}if(null!=b){var g=i.get(i.ACTIVE_SUB_TAB_KEY);a.loadTestCase(b,g,!1)}}}else a.error="Ooops, Something went wrong. Please refresh your page again.";a.loading=!1},1e3)},a.isSelectable=function(){return!0},a.selectTestCase=function(b){a.loadingTC=!0,a.selectedTestCase=b,i.set(i.CB_SELECTED_TESTCASE_ID_KEY,b.id),i.set(i.CB_SELECTED_TESTCASE_TYPE_KEY,b.type),f(function(){a.$broadcast("cb:testCaseSelected",a.selectedTestCase),a.loadingTC=!1})},a.selectNode=function(b,c){f(function(){l.selectNodeByIdAndType(a.tree,b,c)},0)},a.loadTestCase=function(a,b,c){var g=i.get(i.CB_LOADED_TESTCASE_ID_KEY);null!=g&&j.clearRecords(g),g=i.get(i.CB_LOADED_TESTSTEP_ID_KEY),null!=g&&k.clearRecords(g);i.get(i.CB_LOADED_TESTCASE_ID_KEY),i.get(i.CB_LOADED_TESTCASE_TYPE_KEY);i.set(i.CB_LOADED_TESTCASE_ID_KEY,a.id),i.set(i.CB_LOADED_TESTCASE_TYPE_KEY,a.type),(void 0===c||c===!0)&&i.remove(i.CB_EDITOR_CONTENT_KEY),f(function(){d.$broadcast("cb:testCaseLoaded",a,b)}),null!=e.editor&&null!=e.editor.instance&&e.editor.instance.setOption("readOnly",!1)},a.expandAll=function(){null!=a.tree&&a.tree.expand_all()},a.collapseAll=function(){null!=a.tree&&a.tree.collapse_all()}}]),angular.module("cb").controller("CBValidatorCtrl",["$scope","$http","CB","$window","$timeout","$modal","NewValidationResult","$rootScope","ServiceDelegator","StorageService","TestExecutionService",function(a,b,c,d,e,f,g,h,i,j,k){a.cb=c,a.testStep=null,a.message=c.message,a.loading=!0,a.error=null,a.vError=null,a.vLoading=!0,a.mError=null,a.mLoading=!0,a.counter=0,a.type="cb",a.loadRate=4e3,a.tokenPromise=null,a.editorInit=!1,a.nodelay=!1,a.resized=!1,a.selectedItem=null,a.activeTab=0,a.tError=null,a.tLoading=!1,a.dqaCodes=null!=j.get(j.DQA_OPTIONS_KEY)?angular.fromJson(j.get(j.DQA_OPTIONS_KEY)):[],a.domain=null,a.protocol=null,a.showDQAOptions=function(){var b=f.open({templateUrl:"DQAConfig.html",controller:"DQAConfigCtrl",windowClass:"dq-modal",animation:!0,keyboard:!1,backdrop:!1});b.result.then(function(b){a.dqaCodes=b},function(){})},a.isTestCase=function(){return null!=c.testCase&&"TestCase"===c.testCase.type},a.refreshEditor=function(){e(function(){a.editor&&a.editor.refresh()},1e3)},a.loadExampleMessage=function(){if(null!=a.testStep){var b=a.testStep.testContext;if(b){var c=b.message&&null!=b.message?b.message.content:"";a.isTestCase()&&k.setExecutionMessage(a.testStep,c),a.nodelay=!0,a.cb.editor.instance.doc.setValue(c),a.execute()}}},a.options={paramName:"file",formAcceptCharset:"utf-8",autoUpload:!0,type:"POST"},a.$on("fileuploadadd",function(b,c){(c.autoUpload||c.autoUpload!==!1&&$(this).fileupload("option","autoUpload"))&&c.process().done(function(){var b=c.files[0].name;c.url="api/message/upload";c.submit().success(function(c){a.nodelay=!0;var d=angular.fromJson(c);a.cb.message.name=b,a.cb.editor.instance.doc.setValue(d.content),a.mError=null,a.execute()}).error(function(c,d,e){a.cb.message.name=b,a.mError="Sorry, Cannot upload file: "+b+", Error: "+e}).complete(function(){})})}),a.setLoadRate=function(b){a.loadRate=b},a.initCodemirror=function(){a.editor=CodeMirror.fromTextArea(document.getElementById("cb-textarea"),{lineNumbers:!0,fixedGutter:!0,theme:"elegant",readOnly:!1,showCursorWhenSelecting:!0}),a.editor.setSize("100%",345),a.editor.on("keyup",function(){e(function(){var b=a.editor.doc.getValue();a.error=null,a.tokenPromise&&(e.cancel(a.tokenPromise),a.tokenPromise=void 0),""!==b.trim()?a.tokenPromise=e(function(){a.execute()},a.loadRate):a.execute()})}),a.editor.on("dblclick",function(){e(function(){var b=i.getCursorService(a.testStep.testContext.format).getCoordinate(a.editor,a.cb.tree);b&&null!=b&&(b.lineNumber=b.line,b.startIndex=b.startIndex+1,b.endIndex=b.endIndex+1,a.cb.cursor.init(b,!0),i.getTreeService(a.testStep.testContext.format).selectNodeByIndex(a.cb.tree.root,c.cursor,c.message.content))})})},a.validateMessage=function(){try{if(null!=a.testStep)if(""!==a.cb.message.content&&null!=a.testStep.testContext){a.vLoading=!0,a.vError=null;var b=i.getMessageValidator(a.testStep.testContext.format).validate(a.testStep.testContext.id,a.cb.message.content,a.testStep.nav,"Based",[],"1223");b.then(function(b){a.vLoading=!1,a.setValidationReport(b)},function(b){a.vLoading=!1,a.vError=b,a.setValidationReport(null)})}else a.setValidationReport(null),a.vLoading=!1,a.vError=null}catch(c){a.vLoading=!1,a.vError=null,a.setValidationReport(null)}},a.setValidationReport=function(b){null!=a.testStep&&(null!=b&&k.setExecutionStatus(a.testStep,"COMPLETE"),h.$broadcast("cb:validationResultLoaded",b,a.testStep.id))},a.setMessageTree=function(b){a.buildMessageTree(b);var c=b&&null!=b&&b.elements?b:void 0;k.setMessageTree(a.testStep,c)},a.buildMessageTree=function(b){if(null!=a.testStep){var c=b&&null!=b&&b.elements?b.elements:[];"function"==typeof a.cb.tree.root.build_all&&a.cb.tree.root.build_all(c);var d=b&&null!=b&&b.delimeters?b.delimeters:[];i.updateEditorMode(a.editor,d,a.testStep.testContext.format),i.getEditorService(a.testStep.testContext.format).setEditor(a.editor),i.getTreeService(a.testStep.testContext.format).setEditor(a.editor)}},a.clearMessage=function(){a.nodelay=!0,a.mError=null,null!=a.testStep&&(k.deleteValidationReport(a.testStep),k.deleteMessageTree(a.testStep)),a.editor&&(a.editor.doc.setValue(""),a.execute())},a.saveMessage=function(){a.cb.message.download()},a.parseMessage=function(){try{if(null!=a.testStep)if(""!=a.cb.message.content&&null!=a.testStep.testContext){a.tLoading=!0;var b=i.getMessageParser(a.testStep.testContext.format).parse(a.testStep.testContext.id,a.cb.message.content);b.then(function(b){a.tLoading=!1,a.setMessageTree(b)},function(b){a.tLoading=!1,a.tError=b,a.setMessageTree([])})}else a.setMessageTree([]),a.tError=null,a.tLoading=!1}catch(c){a.tLoading=!1,a.tError=c}},a.onNodeSelect=function(b){i.getTreeService(a.testStep.testContext.format).getEndIndex(b,a.cb.message.content),a.cb.cursor.init(b.data,!1),i.getEditorService(a.testStep.testContext.format).select(a.editor,a.cb.cursor)},a.execute=function(){a.tokenPromise&&(e.cancel(a.tokenPromise),a.tokenPromise=void 0),a.error=null,a.tError=null,a.mError=null,a.vError=null,a.cb.message.content=a.editor.doc.getValue(),j.set(j.CB_EDITOR_CONTENT_KEY,a.cb.message.content),a.refreshEditor(),a.isTestCase()&&a.isTestCaseCompleted()?(a.setValidationReport(k.getValidationReport(a.testStep)),a.setMessageTree(k.getMessageTree(a.testStep))):(k.setExecutionMessage(a.testStep,a.cb.message.content),k.deleteValidationReport(a.testStep),k.deleteMessageTree(a.testStep),a.validateMessage(),a.parseMessage())},a.clear=function(){a.vLoading=!1,a.tLoading=!1,a.mLoading=!1,a.error=null,a.tError=null,a.mError=null,a.vError=null,a.setValidationReport(null)},a.removeDuplicates=function(){a.vLoading=!0,a.$broadcast("cb:removeDuplicates")},a.initValidation=function(){a.clear(),a.initCodemirror(),a.$on("cb:refreshEditor",function(){a.refreshEditor()}),a.$on("cb:clearEditor",function(){a.clearMessage()}),h.$on("cb:reportLoaded",function(b,c){null!=a.testStep&&k.setValidationReport(a.testStep,c)}),a.$on("cb:testStepLoaded",function(b,c){if(a.clear(),a.testStep=c,null!=a.testStep.testContext){a.cb.editor=i.getEditor(a.testStep.testContext.format),a.cb.editor.instance=a.editor,a.cb.cursor=i.getCursor(a.testStep.testContext.format);var d=null;a.isTestCase()?(a.nodelay=!0,d=k.getExecutionMessage(a.testStep),d=d&&null!=d?d:""):(a.nodelay=!1,d=null==j.get(j.CB_EDITOR_CONTENT_KEY)?"":j.get(j.CB_EDITOR_CONTENT_KEY)),a.editor&&(a.editor.doc.setValue(d),a.execute())}}),a.$on("cb:removeTestStep",function(){a.testStep=null}),a.$on("cb:loadEditorContent",function(b,c){a.nodelay=!0;var d=null==c?"":c;a.editor.doc.setValue(d),a.cb.message.id=null,a.cb.message.name="",a.execute()}),h.$on("cb:duplicatesRemoved",function(){a.vLoading=!1})},a.expandAll=function(){null!=a.cb.tree.root&&a.cb.tree.root.expand_all()},a.collapseAll=function(){null!=a.cb.tree.root&&a.cb.tree.root.collapse_all()}}]),angular.module("cb").controller("CBProfileViewerCtrl",["$scope","CB",function(a,b){a.cb=b}]),angular.module("cb").controller("CBReportCtrl",["$scope","$sce","$http","CB",function(a,b,c,d){a.cb=d}]),angular.module("cb").controller("CBVocabularyCtrl",["$scope","CB",function(a,b){a.cb=b}]),angular.module("cb").controller("PastTestStepConsoleCtrl",["$scope","$modalInstance","title","log",function(a,b,c,d){a.title=c,a.log=d,a.cancel=function(){b.dismiss("cancel")},a.close=function(){b.close()}}]),angular.module("cb").controller("CurrentTestStepConsoleCtrl",["$scope","$modalInstance","title","logger",function(a,b,c,d){a.title=c,a.logger=d,a.cancel=function(){b.dismiss("cancel")},a.close=function(){b.close()}}]),angular.module("cb").controller("CBManualValidationCtrl",["$scope","CB","$http","TestExecutionService","$timeout","ManualReportService","$rootScope",function(a,b,c,d,e,f,g){a.cb=b,a.saving=!1,a.error=null,a.testStep=null,a.report=null,a.resultOptions=f.resultOptions,a.$on("cb:manualTestStepLoaded",function(b,c){a.testStep=c,a.report=void 0===d.getValidationReport(c)||null===d.getValidationReport(c)?{result:{value:"",comments:""},html:null}:d.getValidationReport(c)}),a.save=function(){a.saving=!0,a.saved=!1,a.error=null,f.save(a.report.result,a.testStep).then(function(b){a.report.id=b.id,a.report.xml=b.xml,d.setExecutionStatus(a.testStep,"COMPLETE");var c=angular.copy(a.report);d.setValidationReport(a.testStep,c),e(function(){g.$emit("cb:manualReportLoaded",c,a.testStep.id)}),a.saving=!1,a.saved=!0},function(b){a.error=b,a.saving=!1,a.saved=!1})}}]),angular.module("cb").controller("CBManualReportCtrl",["$scope","$sce","$http","CB",function(a,b,c,d){a.cb=d}]),angular.module("envelope").controller("EnvelopeTestingCtrl",["$scope","$window","$rootScope","Envelope","StorageService",function(a,b,c,d,e){a.loading=!1,a.error=null,a.tabs=new Array,a.testCaseLoaded=null,a.setActiveTab=function(b){a.tabs[0]=!1,a.tabs[1]=!1,a.tabs[2]=!1,a.activeTab=b,a.tabs[a.activeTab]=!0},a.initTesting=function(){var a=e.get(e.ACTIVE_SUB_TAB_KEY);(null==a||"/envelope_execution"!=a)&&(a="/envelope_testcase"),c.setSubActive(a)},c.$on("env:testCaseLoaded",function(b,e,f){a.testCaseLoaded=d.testCase,null!=d.testCase&&null!=d.testCase.id&&c.setSubActive(f&&null!=f?f:"/envelope_execution")}),a.hasContent=function(){return""!=d.getContent()&&null!=d.getContent()},a.disabled=function(){return null==d.testCase||null===d.testCase.id}}]),angular.module("envelope").controller("EnvelopeExecutionCtrl",["$scope","$window","$rootScope","Envelope",function(a,b,c,d){a.loading=!0,a.error=null,a.tabs=new Array,a.testCase=d.testCase,a.setActiveTab=function(b){a.tabs[0]=!1,a.tabs[1]=!1,a.activeTab=b,a.tabs[a.activeTab]=!0},a.getTestType=function(){return null!=a.testCase?a.testCase.type:""},a.initExecution=function(){a.error=null,a.loading=!1,c.$on("env:testCaseLoaded",function(){a.setActiveTab(0),a.testCase=d.testCase})}}]),angular.module("envelope").controller("EnvelopeTestCaseCtrl",["$scope","$window","$rootScope","Envelope","EnvelopeTestCaseListLoader","$timeout","StorageService","TestCaseService",function(a,b,c,d,e,f,g,h){a.selectedTestCase=d.selectedTestCase,a.testCase=d.testCase,a.testCases=[],a.loading=!0,a.error=null,a.tree={};var i=new h;a.initTestCase=function(){a.error=null,a.testCases=[],a.loading=!0;var b=new e;b.then(function(b){a.error=null,a.testCases=b,a.tree.build_all(a.testCases);var c=null,d=g.get(g.SOAP_ENV_SELECTED_TESTCASE_ID_KEY),e=g.get(g.SOAP_ENV_SELECTED_TESTCASE_TYPE_KEY);if(null!=d&&null!=e){for(var f=0;f<a.testCases.length;f++){var h=i.findOneByIdAndType(d,e,a.testCases[f]);if(null!=h){c=h;break}}null!=c&&(a.selectTestCase(c),a.selectNode(d,e))}if(c=null,d=g.get(g.SOAP_ENV_LOADED_TESTCASE_ID_KEY),e=g.get(g.SOAP_ENV_LOADED_TESTCASE_TYPE_KEY),null!=d&&null!=e){for(var f=0;f<a.testCases.length;f++){var h=i.findOneByIdAndType(d,e,a.testCases[f]);if(null!=h){c=h;break}}if(null!=c){var j=g.get(g.ACTIVE_SUB_TAB_KEY);a.loadTestCase(c,j)}}a.expandAll(),a.loading=!1},function(){a.loading=!1,a.error="Sorry,Cannot fetch the test cases. Please refresh the page."})},a.refreshEditor=function(){f(function(){a.$broadcast("envelope:editor:init")})},a.selectTestCase=function(b){f(function(){a.selectedTestCase=b,g.set(g.SOAP_ENV_SELECTED_TESTCASE_ID_KEY,b.id),g.set(g.SOAP_ENV_SELECTED_TESTCASE_TYPE_KEY,b.type),f(function(){c.$broadcast("env:testCaseSelected")})})},a.selectNode=function(b,c){f(function(){i.selectNodeByIdAndType(a.tree,b,c)})},a.loadTestCase=function(b,e){if(null!=CB.editor.instance&&CB.editor.instance.setOption("readOnly",!1),"TestCase"===b.type){d.testCase=b,a.testCase=d.testCase;var h=g.get(g.SOAP_ENV_LOADED_TESTCASE_ID_KEY),i=g.get(g.SOAP_ENV_LOADED_TESTCASE_TYPE_KEY);(h!=a.testCase.id||i!=a.testCase.type)&&(g.set(g.SOAP_ENV_LOADED_TESTCASE_ID_KEY,a.testCase.id),g.set(g.SOAP_ENV_LOADED_TESTCASE_TYPE_KEY,a.testCase.type),g.remove(g.SOAP_ENV_EDITOR_CONTENT_KEY)),f(function(){c.$broadcast("env:testCaseLoaded",a.testCase,e)})}},a.isSelectable=function(){return!0},a.expandAll=function(){null!=a.tree&&a.tree.expand_all()},a.collapseAll=function(){null!=a.tree&&a.tree.collapse_all()}}]),angular.module("envelope").controller("EnvelopeValidatorCtrl",["$scope","$http","$window","SOAPFormatter","Envelope","SOAPEditorUtils","$rootScope","SOAPParser","SOAPTreeUtils","EnvelopeValidator","$timeout","StorageService",function(a,b,c,d,e,f,g,h,i,j,k,l){a.testCase=e.testCase,a.selectedTestCase=e.selectedTestCase,a.vLoading=!0,a.vError=null,a.selectedMessage={id:-1,content:""},a.eLoading=!1,a.validating=!1,a.editorInit=!1,a.eError=null,a.vLoading=!1,a.vError=null,a.resized=!1,a.validationSettings=e.validationSettings,a.validationResult=e.validationResult,a.errors=a.validationResult.errors,a.errorsCollection=[].concat(a.errors.data),a.affirmatives=a.validationResult.affirmatives,a.affirmativesCollection=[].concat(a.affirmatives.data),a.alerts=a.validationResult.alerts,a.alertsCollection=[].concat(a.alerts.data),a.ignores=a.validationResult.ignores,a.ignoresCollection=[].concat(a.ignores.data),a.warnings=a.validationResult.warnings,a.warningsCollection=[].concat(a.warnings.data),a.tError=null,a.envelopeTree={},a.tLoading=!1,a.refreshEditor=function(){void 0!=a.editor&&k(function(){a.editor.refresh()},1e3)},a.loadExampleMessage=function(){var b=e.testCase.testContext.exampleMessage.content,c=new d(b);c.then(function(b){a.message(b)},function(c){a.error=c,a.message(b)})},a.message=function(b){e.message.content=b,e.editor.instance.doc.setValue(b),l.set(l.SOAP_ENV_EDITOR_CONTENT_KEY,b),a.refreshEditor(),a.validateMessage(),a.parse()},a.validate=function(){a.vError=null;var b=e.editor.instance.doc.getValue();if(""!=b){a.vLoading=!0;var c=new d(b);c.then(function(b){a.vLoading=!1,a.message(b)},function(b){a.vLoading=!1,a.vError=b,a.setValidationResult({}),"function"==typeof a.envelopeTree.build_all&&a.envelopeTree.build_all([])})}else a.message("")},a.initValidation=function(){a.editor=CodeMirror.fromTextArea(document.getElementById("envelopeTextArea"),{lineNumbers:!0,fixedGutter:!0,mode:"xml",readOnly:!1,showCursorWhenSelecting:!0}),a.editor.on("dblclick",function(b){a.$apply(function(){e.cursor.setLine(b.doc.getCursor(!0).line+1)})}),a.editor.setSize("100%",300),e.editor.init(a.editor),a.tLoading=!1,a.$watch(function(){return e.cursor.updateIndicator},function(){f.select(e.cursor,a.editor)},!0),a.$watch(function(){return e.cursor.toString()},function(){i.selectNode(a.envelopeTree,e.cursor)},!0),g.$on("env:testCaseLoaded",function(){a.testCase=e.testCase;var b=null==l.get(l.SOAP_ENV_EDITOR_CONTENT_KEY)?"":l.get(l.SOAP_ENV_EDITOR_CONTENT_KEY);a.message(b)}),a.setValidationResult({}),a.refreshEditor()},a.options={paramName:"file",formAcceptCharset:"utf-8",autoUpload:!0,type:"POST"},a.$on("fileuploadadd",function(b,c){(c.autoUpload||c.autoUpload!==!1&&$(this).fileupload("option","autoUpload"))&&c.process().done(function(){var b=c.files[0].name;c.url="api/message/upload";c.submit().success(function(c){angular.fromJson(c);a.message(c.content),a.uploadError=null,a.fileName=b}).error(function(c,d,e){a.fileName=b,a.uploadError="Sorry, Cannot upload file: "+b+", Error: "+e}).complete(function(){})})}),a.getMessageName=function(){return e.message.name},a.clearMessage=function(){a.error=null,a.message("")},a.saveMessage=function(){e.message.download()},a.resize=function(){},a.validateMessage=function(){if(a.vLoading=!0,a.vError=null,null!=e.testCase.id&&null!=e.editor.instance&&""!=e.editor.instance.doc.getValue()){var b=(new j).validate(e.message.content,e.testCase.id);b.then(function(b){a.vLoading=!1,a.setValidationResult(b)},function(b){a.vLoading=!1,a.vError=b,a.setValidationResult({})})}else a.setValidationResult({}),a.vLoading=!1,a.vError=null},a.setValidationResult=function(b){e.validationResult.init(b),a.validationResult=e.validationResult,a.errors=a.validationResult.errors,a.affirmatives=a.validationResult.affirmatives,a.alerts=a.validationResult.alerts,a.ignores=a.validationResult.ignores,a.warnings=a.validationResult.warnings,k(function(){g.$emit("env:validationResultLoaded")})},a.select=function(a){-1!=a.line&&e.cursor.setLine(a.line)},a.parse=function(){if(a.tLoading=!0,a.tError=null,null!==e.testCase.id&&""!=e.getContent()){var b=new h(e.getContent());b.then(function(b){a.tLoading=!1,a.envelopeTree.build_all(b),i.expandTree(a.envelopeTree)},function(b){a.tLoading=!1,a.tError=b,a.envelopeTree.build_all([])})}else a.tLoading=!1,a.envelopeTree.build_all([])},a.onEnvelopeNodeSelect=function(a){i.setCoordinate(a,e.cursor)},a.expandAll=function(){null!=a.envelopeTree&&a.envelopeTree.expand_all()},a.collapseAll=function(){null!=a.envelopeTree&&a.envelopeTree.collapse_all()}}]),angular.module("envelope").controller("EnvelopeReportCtrl",["$scope","$sce","$http","Envelope","$rootScope",function(a,b,c,d,e){a.error=null,a.loading=!1,a.testCase=d.testCase,a.report=d.report,e.$on("env:validationResultLoaded",function(){var b=d.validationResult.xml;if(null!=b&&""!=b){a.loading=!0;var c=d.report.generate(b);c.then(function(){a.loading=!1,a.error=null},function(){a.error="Failed to generate the report",a.loading=!1})}else a.loading=!1,a.error=null}),e.$on("env:testCaseLoaded",function(){a.testCase=d.testCase}),a.downloadAs=function(b){a.report.download(b,d.testCase.label,d.validationResult.xml)
}}]),angular.module("tool").controller("ContactCtrl",["$scope","ContactLoader","ContactListLoader",function(a,b,c){a.init=function(){var b=new c;return b.then(function(b){a.contacts=b},function(b){a.error=b}),b}}]),angular.module("tool").controller("AboutCtrl",["$scope","AppInfo",function(){}]),angular.module("tool").controller("HeaderCtrl",["$scope","$location",function(){}]),angular.module("connectivity").controller("ConnectivityTestingCtrl",["$scope","Connectivity","$rootScope","StorageService",function(a,b,c,d){a.testCaseLoaded=null,a.initTesting=function(){var a=d.get(d.ACTIVE_SUB_TAB_KEY);(null==a||"/connectivity_execution"!=a)&&(a="/connectivity_testcase"),c.setSubActive(a)},c.$on("conn:testCaseLoaded",function(d,e){a.testCaseLoaded=b.testCase,c.setSubActive(e&&null!=e?e:"/connectivity_execution")})}]),angular.module("connectivity").controller("ConnectivityTestCaseCtrl",["$scope","Connectivity","$rootScope","ConnectivityTestCaseListLoader","$cookies","$timeout","StorageService","TestCaseService",function(a,b,c,d,e,f,g,h){a.connectivity=b,a.loading=!0,a.error=null,a.testCases=[],a.tree={},a.testCase=b.testCase,a.selectedTestCase=b.selectedTestCase;var i=new h;a.selectTestCase=function(b){f(function(){a.selectedTestCase=b,g.set(g.SOAP_CONN_SELECTED_TESTCASE_ID_KEY,b.id),g.set(g.SOAP_CONN_SELECTED_TESTCASE_TYPE_KEY,b.type),f(function(){c.$broadcast("conn:testCaseSelected")})})},a.initTestCase=function(){a.error=null,a.loading=!0,a.testCases=[];var b=new d;b.then(function(b){a.testCases=b,a.tree.build_all(a.testCases);var c=null,d=g.get(g.SOAP_CONN_SELECTED_TESTCASE_ID_KEY),e=g.get(g.SOAP_CONN_SELECTED_TESTCASE_TYPE_KEY);if(null!=d&&null!=e){for(var f=0;f<a.testCases.length;f++){var h=i.findOneByIdAndType(d,e,a.testCases[f]);if(null!=h){c=h;break}}null!=c&&(a.selectTestCase(c),a.selectNode(d,e))}if(c=null,d=g.get(g.SOAP_CONN_LOADED_TESTCASE_ID_KEY),e=g.get(g.SOAP_CONN_LOADED_TESTCASE_TYPE_KEY),null!=d&&null!=e){for(var f=0;f<a.testCases.length;f++){var h=i.findOneByIdAndType(d,e,a.testCases[f]);if(null!=h){c=h;break}}if(null!=c){var j=g.get(g.ACTIVE_SUB_TAB_KEY);a.loadTestCase(c,j)}}a.expandAll(),a.loading=!1,a.error=null},function(){a.error="Sorry, Failed to fetch the test cases. Please refresh page and try again.",a.loading=!1})},a.loadTestCase=function(d,e){b.testCase=d,a.testCase=b.testCase;var h=g.get(g.SOAP_CONN_LOADED_TESTCASE_ID_KEY),i=g.get(g.SOAP_CONN_LOADED_TESTCASE_TYPE_KEY);(h!=a.testCase.id||i!=a.testCase.type)&&(g.set(g.SOAP_CONN_LOADED_TESTCASE_ID_KEY,a.testCase.id),g.set(g.SOAP_CONN_LOADED_TESTCASE_TYPE_KEY,a.testCase.type),g.remove(g.SOAP_CONN_REQ_EDITOR_CONTENT_KEY),g.remove(g.SOAP_CONN_RESP_EDITOR_CONTENT_KEY)),f(function(){c.$broadcast("conn:testCaseLoaded",e)})},a.isSelectable=function(){return!0},a.selectNode=function(b,c){f(function(){i.selectNodeByIdAndType(a.tree,b,c)},0)},a.expandAll=function(){null!=a.tree&&a.tree.expand_all()},a.collapseAll=function(){null!=a.tree&&a.tree.collapse_all()}}]),angular.module("connectivity").controller("ConnectivityExecutionCtrl",["$scope","$timeout","$interval","Connectivity","$rootScope","$modal","Endpoint","$cookies","StorageService","TestExecutionClock","SOAPConnectivityTransport",function(a,b,c,d,e,f,g,h,i,j,k){a.logger=d.logger,a.loading=!1,a.testCase=d.testCase,a.selectedTestCase=d.selectedTestCase,a.loading=!1,a.connecting=!1,a.error=null,a.endpoint=null,a.transport=k,a.hidePwd=!0,a.initExecution=function(){e.$on("conn:testCaseLoaded",function(){a.testCase=d.testCase,a.logger.init(),a.loading=!0,a.error=null,a.connecting=!1,j.stop()})},a.log=function(b){a.logger.log(b)},a.isValidConfig=function(){var b=k.domain,c=k.protocol,d=a.transport.configs[b]&&null!=a.transport.configs[b]&&a.transport.configs[b][c]&&null!=a.transport.configs[b][c]&&a.transport.configs[b][c].data&&null!=a.transport.configs[b][c].data?a.transport.configs[b][c].data.taInitiator:null;return d&&null!=d&&null!=d.endpoint&&""!=d.endpoint},a.openReceiverConfig=function(){a.logger.init();var b=f.open({templateUrl:"TransactionReceiver.html",controller:"ConnectivityReceiverCtrl",windowClass:"app-modal-window",resolve:{testCase:function(){return d.testCase},logger:function(){return d.logger},message:function(){return d.request.getContent()}}});b.result.then(function(b){null!=b.received&&a.triggerReqEvent(b.received),null!=b.sent&&a.triggerRespEvent(b.sent)},function(){a.triggerReqEvent(""),a.triggerRespEvent("")})},a.hasRequestContent=function(){return null!=a.message&&""!=a.message},a.send=function(){if(a.error=null,a.isValidConfig()&&a.hasRequestContent()){a.connecting=!0,a.logger.init();{f.open({templateUrl:"SOAPConnectivityConsole.html",controller:"SOAPConnectivityConsoleCtrl",size:"lg",backdrop:"static",resolve:{logger:function(){return a.logger}}})}a.received="",a.logger.log("Sending outbound message. Please wait...");var b=a.transport.send(a.testCase.id);b.then(function(b){var c=b.incoming,d=b.outgoing;a.logger.log("Outbound Message  -------------------------------------->"),null!=d&&""!=d?(a.logger.log(d),a.logger.log("Inbound Message  <--------------------------------------"),null!=c&&""!=c?(a.logger.log(c),a.triggerRespEvent(c)):a.logger.log("No Inbound message received"),a.triggerReqEvent(d)):a.logger.log("No outbound message sent"),a.connecting=!1,a.logger.log("Transaction completed")},function(b){a.connecting=!1,a.error=b.data,a.logger.log("Error: "+b.data),a.logger.log("Transaction completed"),a.triggerRespEvent("")})}else a.error="No Outbound message found",a.connecting=!1,a.triggerRespEvent("")},a.configureReceiver=function(){f.open({templateUrl:"TransactionConfigureReceiver.html",controller:"ConnectivityConfigureReceiverCtrl",resolve:{taInitiatorConfig:function(){var a=k.configs[k.domain][k.protocol].data;return a.taInitiator}}})},a.hasRequestContent=function(){return null!=d.request.getContent()&&""!=d.request.getContent()},a.triggerReqEvent=function(a){b(function(){e.$broadcast("conn:reqMessage",a)})},a.triggerRespEvent=function(a){b(function(){e.$broadcast("conn:respMessage",a)})}}]),angular.module("connectivity").controller("ConnectivityReqCtrl",["$scope","$http","Connectivity","SOAPFormatter","$window","SOAPEditorUtils","$timeout","$rootScope","ConnectivityValidator","$modal","StorageService",function(a,b,c,d,e,f,g,h,i,j,k){a.eLoading=!1,a.vError=null,a.request=c.request,a.editor=null,a.request=c.request,a.validating=!1,a.editorInit=!1,a.serverEndpoint=c.serverEndpoint,a.request=c.request,a.rLoading=!1,a.rError=null,a.resized=!1,a.validationSettings=a.request.validationSettings,a.validationResult=a.request.validationResult,a.editor=a.request.editor,a.itemsByPage=10,a.errors=a.validationResult.errors,a.errorsCollection=[].concat(a.errors.data),a.affirmatives=a.validationResult.affirmatives,a.affirmativesCollection=[].concat(a.affirmatives.data),a.alerts=a.validationResult.alerts,a.alertsCollection=[].concat(a.alerts.data),a.ignores=a.validationResult.ignores,a.ignoresCollection=[].concat(a.ignores.data),a.warnings=a.validationResult.warnings,a.warningsCollection=[].concat(a.warnings.data),a.selectedExampleMessage={id:-1,content:""},a.error=null,a.options={paramName:"file",formAcceptCharset:"utf-8",autoUpload:!0,type:"POST"},a.hasContent=function(){return""!=a.request.getContent()&&null!=a.request.getContent()},a.getMessageName=function(){return a.editor.message.name},a.$on("fileuploadadd",function(b,c){(c.autoUpload||c.autoUpload!==!1&&$(this).fileupload("option","autoUpload"))&&c.process().done(function(){var b=c.files[0].name;c.url="api/message/upload";c.submit().success(function(c){var d=angular.fromJson(c);a.request.editor.instance.doc.setValue(d.content),a.uploadError=null,a.fileName=b}).error(function(c,d,e){a.fileName=b,a.uploadError="Sorry, Failed to upload file: "+b+", Error: "+e}).complete(function(){})})}),a.validate=function(){a.vError=null;var b=a.request.editor.instance.doc.getValue();if(null!=b&&""!=b){a.validating=!0;var c=new d(b);c.then(function(b){a.validating=!1,a.reqMessage(b)},function(b){a.validating=!1,a.vError=b})}},a.clearMessage=function(){a.error=null,a.reqMessage("")},a.refreshEditor=function(){g(function(){void 0!=a.editor&&a.editor.refresh()},1e3)},a.saveMessage=function(){a.request.message.download()},a.resize=function(){},a.validateMessage=function(){if(a.refreshEditor(),a.rLoading=!0,a.rError=null,null!=a.testCase&&""!=a.request.getContent()){var b=(new i).validate(a.request.message.content,a.testCase.id,"req",null);b.then(function(b){a.rLoading=!1,a.setValidationResult(b)},function(b){a.rLoading=!1,a.rError=b,a.setValidationResult({})})}else a.setValidationResult({}),a.rLoading=!1,a.rError=null},a.setValidationResult=function(b){a.request.validationResult.init(b),a.validationResult=a.request.validationResult,a.errors=a.validationResult.errors,a.affirmatives=a.validationResult.affirmatives,a.alerts=a.validationResult.alerts,a.ignores=a.validationResult.ignores,a.warnings=a.validationResult.warnings},a.select=function(a){-1!=a.line&&c.request.cursor.setLine(a.line)},a.initRequest=function(){a.error=null,a.loading=!0,a.editor=CodeMirror.fromTextArea(document.getElementById("connectivityReqTextArea"),{lineNumbers:!0,fixedGutter:!0,mode:"xml",readOnly:!1,showCursorWhenSelecting:!0}),a.editor.setOption("readOnly",!0),a.editor.setSize("100%",300),a.editor.on("dblclick",function(){a.$apply(function(){a.request.cursor.setLine(a.editor.doc.getCursor(!0).line+1)})}),a.request.editor.init(a.editor),h.$on("conn:testCaseLoaded",function(){a.testCase=c.testCase;var b="RECEIVER"==c.testCase.sutType?c.testCase.testContext.message:null!=k.get(k.SOAP_CONN_REQ_EDITOR_CONTENT_KEY)?k.get(k.SOAP_CONN_REQ_EDITOR_CONTENT_KEY):"";a.reqMessage(b)}),h.$on("conn:reqMessage",function(b,c){a.reqMessage(c)}),a.$watch(function(){return a.request.cursor.updateIndicator},function(){f.select(a.request.cursor,a.request.editor.instance)},!0),a.setValidationResult({}),a.refreshEditor()},a.reqMessage=function(b){a.request.message.content=b,a.editor.doc.setValue(b),k.set(k.SOAP_CONN_REQ_EDITOR_CONTENT_KEY,b),a.validateMessage()},a.triggerRespEvent=function(a){h.$broadcast("conn:respMessage",a)}}]),angular.module("connectivity").controller("ConnectivityReqReportCtrl",["$scope","$sce","$http","SoapValidationReportGenerator","SoapValidationReportDownloader","Connectivity","$rootScope",function(a,b,c,d,e,f,g){a.connectivityReqHtmlReport=null,a.error=null,a.loading=!1,a.testCase=f.testCase,a.validationResult=f.validationResult,a.init=function(){g.$on("conn:testCaseLoaded",function(){a.testCase=f.testCase}),a.$watch(function(){return a.validationResult.xml},function(b){if(null!=b&&""!=b){a.loading=!0;var c=new d(b,"html");c.then(function(b){a.connectivityReqHtmlReport=b.htmlReport,a.loading=!1,a.error=null},function(b){a.error=b,a.loading=!1,a.connectivityReqHtmlReport=null})}else a.loading=!1,a.connectivityReqHtmlReport=null,a.error=null},!0)},a.downloadAs=function(b){e.downloadAs(a.validationResult.xml,b)}}]),angular.module("connectivity").controller("ConnectivityConfigureReceiverCtrl",["$scope","$sce","$http","Connectivity","$rootScope","$modalInstance","User","taInitiatorConfig","SOAPConnectivityTransport",function(a,b,c,d,e,f,g,h,i){a.testCase=d.testCase,a.config=angular.copy(h),a.save=function(){var b=angular.fromJson({config:a.config,userId:g.info.id,type:"TA_INITIATOR",protocol:"soap",domain:"iz"});c.post("api/transport/config/save",b).then(function(){i.configs[i.domain][i.protocol].data.taInitiator=a.config,f.close(a.config)},function(b){a.error=b.data})},a.cancel=function(){f.dismiss("cancel")}}]),angular.module("connectivity").controller("SOAPConnectivityConsoleCtrl",["$scope","$sce","$http","Connectivity","$rootScope","$modalInstance","logger",function(a,b,c,d,e,f,g){a.logger=g,a.connecting=!1,a.close=function(){f.close()},a.cancel=function(){f.dismiss("cancel")}}]),angular.module("connectivity").controller("ConnectivityRespCtrl",["$scope","$http","Connectivity","$window","SOAPFormatter","SOAPEditorUtils","$timeout","$rootScope","ConnectivityValidator","$modal","StorageService",function(a,b,c,d,e,f,g,h,i,j,k){a.testCase=c.testCase,a.response=c.response,a.selectedTestCase=c.selectedTestCase,a.loading=!0,a.error=null,a.eLoading=!1,a.validating=!1,a.editorInit=!1,a.rLoading=!1,a.rError=null,a.resized=!1,a.validationSettings=c.response.validationSettings,a.validationResult=c.response.validationResult,a.itemsByPage=10,a.errors=a.validationResult.errors,a.errorsCollection=[].concat(a.errors.data),a.affirmatives=a.validationResult.affirmatives,a.affirmativesCollection=[].concat(a.affirmatives.data),a.alerts=a.validationResult.alerts,a.alertsCollection=[].concat(a.alerts.data),a.ignores=a.validationResult.ignores,a.ignoresCollection=[].concat(a.ignores.data),a.warnings=a.validationResult.warnings,a.warningsCollection=[].concat(a.warnings.data),a.options={paramName:"file",formAcceptCharset:"utf-8",autoUpload:!0,type:"POST"},a.error=null,a.initResponse=function(){a.error=null,a.testCases=[],a.loading=!0,a.editor=CodeMirror.fromTextArea(document.getElementById("connectivityRespTextArea"),{lineNumbers:!0,fixedGutter:!0,mode:"xml",readOnly:!1,showCursorWhenSelecting:!0}),a.editor.setOption("readOnly",!0),a.editor.setSize("100%",300),a.editor.on("dblclick",function(){a.$apply(function(){a.response.cursor.setLine(a.editor.doc.getCursor(!0).line+1)}),event.preventDefault()}),a.response.editor.init(a.editor),a.$watch(function(){return a.response.cursor.updateIndicator},function(){f.select(a.response.cursor,a.editor)},!0),h.$on("conn:testCaseLoaded",function(){a.testCase=c.testCase,a.refreshEditor();var b=k.get(k.SOAP_CONN_RESP_EDITOR_CONTENT_KEY);a.respMessage(null!=b?b:"")}),h.$on("conn:respMessage",function(b,c){a.respMessage(c)}),a.setValidationResult({}),a.refreshEditor()},a.respMessage=function(b){a.response.message.content=b,a.editor.doc.setValue(b),k.set(k.SOAP_CONN_RESP_EDITOR_CONTENT_KEY,b),a.refreshEditor(),a.validateMessage()},a.triggerReqEvent=function(a){h.$broadcast("conn:reqMessage",a)},a.triggerRespEvent=function(a){h.$broadcast("conn:respMessage",a)},a.hasContent=function(){return""!=a.response.getContent()&&null!=a.response.getContent()},a.getMessageName=function(){return a.response.message.name},a.clearMessage=function(){a.error=null,a.respMessage("")},a.refreshEditor=function(){void 0!=a.editor&&g(function(){a.editor.refresh()},1e3)},a.saveMessage=function(){a.response.message.download()},a.validate=function(){a.error=null;var b=a.response.editor.instance.doc.getValue();if(null!=b&&""!=b){a.validating=!0;var c=new e(b);c.then(function(b){a.validating=!1,a.respMessage(b)},function(b){a.validating=!1,a.error=b})}},a.resize=function(){},a.validateMessage=function(){if(a.rLoading=!0,a.rError=null,null!=c.testCase&&""!=c.response.getContent()){var b=(new i).validate(a.response.message.content,c.testCase.id,"resp",c.request.getContent());b.then(function(b){a.rLoading=!1,a.setValidationResult(b)},function(b){a.rLoading=!1,a.rError=b,a.setValidationResult({})})}else a.setValidationResult({}),a.rLoading=!1,a.rError=null},a.setValidationResult=function(b){a.response.validationResult.init(b),a.validationResult=a.response.validationResult,a.errors=a.validationResult.errors,a.affirmatives=a.validationResult.affirmatives,a.alerts=a.validationResult.alerts,a.ignores=a.validationResult.ignores,a.warnings=a.validationResult.warnings},a.select=function(a){-1!=a.line&&c.response.cursor.setLine(a.line)}}]),angular.module("connectivity").controller("ConnectivityRespReportCtrl",["$scope","$sce","$http","SoapValidationReportGenerator","SoapValidationReportDownloader","Connectivity",function(a,b,c,d,e,f){a.connectivityRespHtmlReport=null,a.error=null,a.loading=!1,a.testCase=f.testCase,a.init=function(){a.$watch(function(){return f.response.validationResult.xml},function(c){if(null!=c&&""!=c){a.loading=!0;var e=new d(c,"html");e.then(function(c){a.connectivityRespHtmlReport=b.trustAsHtml(c.htmlReport),a.loading=!1,a.error=null},function(b){a.error=b,a.loading=!1,a.connectivityRespHtmlReport=null})}else a.loading=!1,a.connectivityRespHtmlReport=null,a.error=null},!0)},a.downloadAs=function(a){e.downloadAs(f.response.validationResult.xml,a)}}]),angular.module("connectivity").controller("ConnectivityReceiverCtrl",["$scope","$sce","$http","Connectivity","$rootScope","$modalInstance","testCase","logger","TestExecutionClock","message","SOAPConnectivityTransport",function(a,b,c,d,e,f,g,h,i,j,k){a.testCase=g,a.transport=k,a.config=k.configs.iz.soap.data.sutInitiator,a.logger=h,a.message=j,a.sent=null,a.received=null,a.connecting=!1,a.error=null,a.counterMax=30,a.counter=0,a.listenerReady=!1,a.warning=null,a.domain=k.domain,a.protocol=k.protocol,a.log=function(b){a.logger.log(b)},a.close=function(){f.close({sent:a.sent,received:a.received})},a.cancel=function(){f.dismiss("cancel")},a.hasRequestContent=function(){return null!=a.message&&""!=a.message},a.stopListener=function(){a.connecting=!1,a.counter=a.counterMax,i.stop(),a.log("Stopping listener. Please wait...."),a.transport.stopListener(a.testCase.id,a.domain,a.protocol).then(function(){a.log("Listener stopped.")},function(b){a.log("Failed to stop the listener. Error is "+b),a.error="Failed to stop the listener. Error is "+b})},a.startListener=function(){a.logger.clear(),a.counter=0,a.connecting=!0,a.received="",a.sent="",a.error=null,a.warning=null,a.log("Starting listener. Please wait...");var b=0;a.transport.startListener(a.testCase.id,b,a.domain,a.protocol).then(function(c){if(c){a.log("Listener started.");var d=function(){++a.counter,a.log("Waiting for incoming message....Elapsed time(second):"+a.counter+"s"),a.transport.searchTransaction(a.testCase.id,k.configs[a.domain][a.protocol].data.sutInitiator,b).then(function(b){if(null!=b){var c=b.incoming,d=b.outgoing;a.log("Incoming Message <--------------------------------------"),null!=c&&""!=c?(a.log(c),a.received=c):a.log("Incoming message received is empty"),a.log("Outgoing Message:    -------------------------------------->"),null!=d&&""!=d?(a.log(d),a.sent=d):a.log("Outbound message sent is empty"),a.stopListener()}else a.counter>=a.counterMax&&(a.warning="We did not receive any incoming message after 30s. <p>Possible cause (1): You are using wrong credentials. Please check the credentials in your outbound SOAP Envelope against those created for your system.</p>  <p>Possible cause (2):The SOAP endpoint address may be incorrect.   Verify that you are using the correct SOAP endpoint address that is displayed by the tool.</p><p>Possible cause (3):The HTTP header field Content-Type  may not be set correctly for use with SOAP 1.2.   SOAP 1.2 requires application/soap+xml, and SOAP 1.2 requires text/xml.  The NIST Tool follows SOAP 1.2, which is required by section 2 of the 'CDC Transport Layer Protocol Recommendation V1.1' (http://www.cdc.gov/vaccines/programs/iis/technical-guidance/SOAP/downloads/transport-specification.pdf)</p>",a.log("We did not receive any incoming message after 30s"),a.stopListener())},function(b){a.error=b,a.log("Error: "+b),a.received="",a.sent="",a.stopListener()})};i.start(d)}else a.error="Failed to start the listener. Please contact the administrator for any question",a.log(a.error),a.log("Transaction aborted"),a.connecting=!1,a.counter=a.counterMax,i.stop()},function(b){a.error="Failed to start the listener. Error is "+b,a.log(a.error),a.received="",a.sent="",a.connecting=!1,a.counter=a.counterMax,i.stop()})}}]),angular.module("hit-tool-directives").directive("compile",["$compile",function(a){return function(b,c,d){b.$watch(function(a){return a.$eval(d.compile)},function(d){c.html(d),a(c.contents())(b)})}}]),angular.module("hit-tool-directives").directive("stRatio",function(){return{link:function(a,b,c){var d=+c.stRatio;b.css("width",d+"%")}}}),angular.module("hit-tool-directives").directive("csSelect",function(){return{require:"^stTable",template:"",scope:{row:"=csSelect"},link:function(a,b,c,d){b.bind("change",function(){a.$apply(function(){d.select(a.row,"single")})}),a.$watch("row.isSelected",function(a){a===!0?b.parent().addClass("st-selected"):b.parent().removeClass("st-selected")})}}}),angular.module("hit-tool-directives").directive("mypopover",["$compile","$templateCache",function(a,b){return{restrict:"A",link:function(a,c){var d=b.get("profileInfo.html"),e={content:d,placement:"bottom",html:!0};$(c).popover(e)}}}]),angular.module("hit-tool-directives").directive("windowExit",["$window","$templateCache","$http","User",function(a,b){return{restrict:"AE",compile:function(){var c=a.attachEvent||a.addEventListener,d=a.attachEvent?"onbeforeunload":"beforeunload";c(d,function(){b.removeAll()})}}}]);